---
title: Esercitazioni su Ancoraggi nello spazio di Azure - 3. Salvataggio, recupero e condivisione di ancoraggi nello spazio di Azure
description: In questo corso viene illustrato come salvare, recuperare e condividere Ancoraggi nello spazio di Azure in un'applicazione di realtà mista.
author: jessemcculloch
ms.author: jemccull
ms.date: 07/01/2020
ms.topic: article
keywords: realtà mista, unity, esercitazione, hololens, MRTK, mixed reality toolkit, UWP, ancoraggi nello spazio di Azure, sessioni dell'app
ms.localizationpriority: high
ms.openlocfilehash: c085aecef1ce32565d2f3bbbf1d5fdb2da91c217
ms.sourcegitcommit: dd13a32a5bb90bd53eeeea8214cd5384d7b9ef76
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 11/17/2020
ms.locfileid: "94679410"
---
# <a name="3-saving-retrieving-and-sharing-azure-spatial-anchors"></a><span data-ttu-id="c84ac-105">3. Salvataggio, recupero e condivisione di ancoraggi nello spazio di Azure</span><span class="sxs-lookup"><span data-stu-id="c84ac-105">3. Saving, retrieving, and sharing Azure Spatial Anchors</span></span>

<span data-ttu-id="c84ac-106">In questa esercitazione apprenderai come salvare gli ancoraggi nello spazio di Azure in più sessioni dell'app salvando l'ID ancoraggio nella memoria di HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="c84ac-106">In this tutorial, you will learn how to save Azure Spatial Anchors across multiple app sessions by saving the anchor ID to the HoloLens 2's storage.</span></span> <span data-ttu-id="c84ac-107">Apprenderai anche come condividere questo ID con altri dispositivi per un allineamento degli ancoraggi su più dispositivi.</span><span class="sxs-lookup"><span data-stu-id="c84ac-107">You will also learn how to share this anchor ID to other devices for a multi-device anchor alignment.</span></span>

## <a name="objectives"></a><span data-ttu-id="c84ac-108">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="c84ac-108">Objectives</span></span>

* <span data-ttu-id="c84ac-109">Apprendere come ottenere l'allineamento spaziale tra più sessioni dell'app.</span><span class="sxs-lookup"><span data-stu-id="c84ac-109">Learn how to achieve spatial alignment across multiple app sessions.</span></span>
* <span data-ttu-id="c84ac-110">Apprendere come ottenere l'allineamento spaziale tra più dispositivi.</span><span class="sxs-lookup"><span data-stu-id="c84ac-110">Learn how to achieve spatial alignment between multiple devices.</span></span>

## <a name="preparing-the-scene"></a><span data-ttu-id="c84ac-111">Preparazione della scena</span><span class="sxs-lookup"><span data-stu-id="c84ac-111">Preparing the scene</span></span>

<span data-ttu-id="c84ac-112">Nella finestra Hierarchy (Gerarchia) espandi l'oggetto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="c84ac-112">In the Hierarchy window, expand the **ButtonParent** object.</span></span> <span data-ttu-id="c84ac-113">Seleziona gli **ultimi quattro oggetti pulsante figlio**.</span><span class="sxs-lookup"><span data-stu-id="c84ac-113">Select the **last four child button** objects.</span></span> <span data-ttu-id="c84ac-114">Nella finestra Inspector (Controllo) **seleziona** la casella di controllo accanto al campo del nome per rendere attivi tutti gli oggetti.</span><span class="sxs-lookup"><span data-stu-id="c84ac-114">In the Inspector window, **check** the checkbox next to the name field to make all the objects active.</span></span>

![Unity con oggetti pulsante precedentemente inattivi selezionati e attivi](images/mr-learning-asa/asa-03-section1-step1-1.png)

<span data-ttu-id="c84ac-116">Nella finestra Hierarchy (Gerarchia) seleziona gli oggetti **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="c84ac-116">In the Hierarchy window, select the **ButtonParent** objects.</span></span> <span data-ttu-id="c84ac-117">Quindi nella finestra Inspector (Controllo) individua il componente **GridObjectCollection** e fai clic sul pulsante **Update Collection** (Aggiorna raccolta) per aggiornare la posizione di tutti gli oggetti figlio dell'oggetto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="c84ac-117">Then in the Inspector window, locate the **GridObjectCollection** component and click the **Update Collection** button to update the position of all the **ButtonParent** object's child objects.</span></span>

![Unity con il componente GridObjectCollection aggiornato](images/mr-learning-asa/asa-03-section1-step1-2.png)

## <a name="persisting-azure-spatial-anchors-between-app-sessions"></a><span data-ttu-id="c84ac-119">Mantenimento degli ancoraggi nello spazio di Azure tra sessioni dell'app</span><span class="sxs-lookup"><span data-stu-id="c84ac-119">Persisting Azure Spatial Anchors between app sessions</span></span>

<span data-ttu-id="c84ac-120">In questa sezione apprenderai come salvare e recuperare l'ID ancoraggio di Azure sul e dal disco locale di HoloLens.</span><span class="sxs-lookup"><span data-stu-id="c84ac-120">In this section, you will learn how to save and retrieve the Azure Anchor ID to and from the HoloLens' local disk.</span></span> <span data-ttu-id="c84ac-121">In questo modo potrai eseguire query su Azure per ottenere lo stesso ID ancoraggio tra sessioni diverse dell'app</span><span class="sxs-lookup"><span data-stu-id="c84ac-121">This will allow you to query Azure for the same anchor ID between different app sessions.</span></span> <span data-ttu-id="c84ac-122">e gli ologrammi ancorati potranno essere collocati nella stessa posizione in cui si trovavano nella sessione precedente dell'app.</span><span class="sxs-lookup"><span data-stu-id="c84ac-122">It will enable the anchored holograms to be positioned at the same location as in the previous app session.</span></span>

<span data-ttu-id="c84ac-123">Nella finestra Hierarchy (Gerarchia) espandi l'oggetto **ButtonParent** e individua i due pulsanti denominati **SaveAzureAnchorIdToDisk** e **GetAzureAnchorIdFromDisk**:</span><span class="sxs-lookup"><span data-stu-id="c84ac-123">In the Hierarchy window, expand the **ButtonParent** object and locate the two buttons named **SaveAzureAnchorIdToDisk** and **GetAzureAnchorIdFromDisk**:</span></span>

![Unity gli oggetti pulsante SaveAzureAnchorIdToDisk e GetAzureAnchorIdFromDisk selezionati](images/mr-learning-asa/asa-03-section2-step1-1.png)

<span data-ttu-id="c84ac-125">Segui la stessa procedura illustrata nelle istruzioni per la [configurazione dei pulsanti per il funzionamento della scena](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) contenute nell'esercitazione precedente per configurare il componente **Interactable (Script)** (Con supporto per interazioni - Script) per ognuno dei due pulsanti:</span><span class="sxs-lookup"><span data-stu-id="c84ac-125">Follow the same steps as in the [configuring the buttons to operate the scene](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="c84ac-126">Per l'oggetto pulsante **SaveAzureAnchorIdToDisk**, assegna la funzione AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="c84ac-126">For the **SaveAzureAnchorIdToDisk** button object, assign the AnchorModuleScript > **SaveAzureAnchorIdToDisk ()** function.</span></span>
* <span data-ttu-id="c84ac-127">Per l'oggetto pulsante **GetAzureAnchorIdFromDisk**, assegna la funzione AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** .</span><span class="sxs-lookup"><span data-stu-id="c84ac-127">For the **GetAzureAnchorIdFromDisk** button object, assign the AnchorModuleScript > **GetAzureAnchorIdFromDisk ()** function.</span></span>

<span data-ttu-id="c84ac-128">Se compili l'app aggiornata in HoloLens, ora puoi rendere permanenti gli ancoraggi nello spazio di Azure, ovvero mantenerli da una sessione all'altra dell'app salvando l'ID ancoraggio di Azure.</span><span class="sxs-lookup"><span data-stu-id="c84ac-128">If you build the updated app to your HoloLens, you can now persist Azure Spatial Anchors between app sessions by saving the Azure Anchor ID.</span></span> <span data-ttu-id="c84ac-129">Per provare, puoi seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="c84ac-129">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="c84ac-130">Sposta Rover Explorer (Esplora Rover) nella posizione desiderata</span><span class="sxs-lookup"><span data-stu-id="c84ac-130">Move the Rover Explorer to the desired location</span></span>
2. <span data-ttu-id="c84ac-131">Avvia la sessione di Azure</span><span class="sxs-lookup"><span data-stu-id="c84ac-131">Start Azure Session</span></span>
3. <span data-ttu-id="c84ac-132">Crea l'ancoraggio di Azure; gli ancoraggi vengono creati nella posizione di Rover Explorer (Esplora Rover)</span><span class="sxs-lookup"><span data-stu-id="c84ac-132">Create Azure Anchor (creates anchors at the location of the Rover Explorer)</span></span>
4. <span data-ttu-id="c84ac-133">Salva l'ID ancoraggio di Azure su disco</span><span class="sxs-lookup"><span data-stu-id="c84ac-133">Save Azure Anchor ID to Disk</span></span>
5. <span data-ttu-id="c84ac-134">Riavvia l'app</span><span class="sxs-lookup"><span data-stu-id="c84ac-134">Restart the app</span></span>
6. <span data-ttu-id="c84ac-135">Recupera l'ancoraggio di Azure dal disco; viene caricato l'ID ancoraggio appena salvato</span><span class="sxs-lookup"><span data-stu-id="c84ac-135">Get Azure Anchor from Disk (loads the anchor ID you just saved)</span></span>
7. <span data-ttu-id="c84ac-136">Avvia la sessione di Azure</span><span class="sxs-lookup"><span data-stu-id="c84ac-136">Start Azure Session</span></span>
8. <span data-ttu-id="c84ac-137">Trova l'ancoraggio di Azure; l'esperienza Rover Explorer (Esplora Rover) viene collocata nella posizione del passaggio 3</span><span class="sxs-lookup"><span data-stu-id="c84ac-137">Find Azure Anchor (positions the Rover Explorer at the location from step 3)</span></span>

> [!NOTE]
> <span data-ttu-id="c84ac-138">Per riavviare completamente l'app, dopo aver chiuso la visualizzazione di app immersiva devi chiudere la finestra dell'app nell'ambiente iniziale di realtà mista prima di eseguire il riavvio dal menu Start.</span><span class="sxs-lookup"><span data-stu-id="c84ac-138">To fully restart the app, after exiting the immersive app view, the app window in the mixed reality home needs to be closed before relaunching it from the Start menu.</span></span> <span data-ttu-id="c84ac-139">Per altri dettagli, puoi fare riferimento alla documentazione sull'[uso di app in HoloLens](https://docs.microsoft.com/hololens/holographic-home#using-apps-on-hololens).</span><span class="sxs-lookup"><span data-stu-id="c84ac-139">For additional details, you can refer to the [Using apps on HoloLens](https://docs.microsoft.com/hololens/holographic-home#using-apps-on-hololens) documentation.</span></span>

## <a name="sharing-azure-spatial-anchors-between-devices"></a><span data-ttu-id="c84ac-140">Condivisione degli ancoraggi nello spazio di Azure tra dispositivi</span><span class="sxs-lookup"><span data-stu-id="c84ac-140">Sharing Azure Spatial Anchors between devices</span></span>

<span data-ttu-id="c84ac-141">In questa sezione apprenderai come condividere l'ID ancoraggio di Azure tra più dispositivi.</span><span class="sxs-lookup"><span data-stu-id="c84ac-141">In this section, you will learn how to share the Azure Anchor ID between multiple devices.</span></span> <span data-ttu-id="c84ac-142">In questo modo, diversi dispositivi potranno eseguire query su Azure per ottenere lo stesso ID ancoraggio, consentendo l'allineamento spaziale degli ologrammi ancorati.</span><span class="sxs-lookup"><span data-stu-id="c84ac-142">This will allow multiple devices to query Azure for the same anchor ID, allowing the anchored holograms to be spatially aligned.</span></span> <span data-ttu-id="c84ac-143">L'allineamento spaziale, ovvero la visualizzazione degli stessi ologrammi nella stessa posizione fisica su più dispositivi, è fondamentale per le esperienze condivise locali in HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="c84ac-143">Spatial alignment, i.e., seeing the same holograms in the same physical location between multiple devices, is key to local shared experiences in the HoloLens 2.</span></span>

<span data-ttu-id="c84ac-144">Esistono diversi modi per trasferire gli ID ancoraggio di Azure da un dispositivo all'altro, inclusi i metodi descritti nella serie [Esercitazioni sulle funzionalità multiutente](mr-learning-sharing-02.md).</span><span class="sxs-lookup"><span data-stu-id="c84ac-144">There are many ways to transfer Azure Anchor IDs between devices, including methods outlined in the [Multi-user capabilities tutorials](mr-learning-sharing-02.md) series.</span></span> <span data-ttu-id="c84ac-145">In questo esempio userai un servizio Web semplice per caricare e scaricare gli ID ancoraggio tra dispositivi.</span><span class="sxs-lookup"><span data-stu-id="c84ac-145">In this example, you will use a simple web service to upload and download anchor IDs between devices.</span></span>

<span data-ttu-id="c84ac-146">Nella finestra Hierarchy (Gerarchia) espandi l'oggetto **ButtonParent**.</span><span class="sxs-lookup"><span data-stu-id="c84ac-146">In the Hierarchy window, expand the **ButtonParent** object.</span></span>   <span data-ttu-id="c84ac-147">Individua i due pulsanti denominati **ShareAzureAnchorIdToNetwork** e **GetAzureAnchorIdFromNetwork**:</span><span class="sxs-lookup"><span data-stu-id="c84ac-147">Locate the two buttons named **ShareAzureAnchorIdToNetwork** and **GetAzureAnchorIdFromNetwork**:</span></span>

![Unity con gli oggetti pulsante ShareAzureAnchorIdToNetwork e GetAzureAnchorIdFromNetwork selezionati](images/mr-learning-asa/asa-03-section3-step1-1.png)

<span data-ttu-id="c84ac-149">Segui la stessa procedura illustrata nelle istruzioni per la [configurazione dei pulsanti per il funzionamento della scena](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) contenute nell'esercitazione precedente per configurare il componente **Interactable (Script)** (Con supporto per interazioni - Script) per ognuno dei due pulsanti:</span><span class="sxs-lookup"><span data-stu-id="c84ac-149">Follow the same steps as in the [configuring the buttons to operate the scene](mr-learning-asa-02.md#configuring-the-buttons-to-operate-the-scene) instructions from the previous tutorial to configure the **Interactable (Script)** component on each of the two buttons:</span></span>

* <span data-ttu-id="c84ac-150">Per l'oggetto **ShareAzureAnchorIdToNetwork**, assegna la funzione AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="c84ac-150">For the **ShareAzureAnchorIdToNetwork** object, assign the AnchorModuleScript > **ShareAzureAnchorIdToNetwork ()** function.</span></span>
* <span data-ttu-id="c84ac-151">Per l'oggetto **GetAzureAnchorIdFromNetwork**, assegna la funzione AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** .</span><span class="sxs-lookup"><span data-stu-id="c84ac-151">For the **GetAzureAnchorIdFromNetwork** object, assign the AnchorModuleScript > **GetAzureAnchorIdFromNetwork ()** function.</span></span>

<span data-ttu-id="c84ac-152">Se compili l'app aggiornata in due dispositivi HoloLens, ora puoi ottenere l'allineamento spaziale condividendo l'ID ancoraggio di Azure.</span><span class="sxs-lookup"><span data-stu-id="c84ac-152">If you build the updated app to two HoloLens devices, you can now achieve spatial alignment by sharing the Azure Anchor ID.</span></span> <span data-ttu-id="c84ac-153">Per provare, puoi seguire questa procedura:</span><span class="sxs-lookup"><span data-stu-id="c84ac-153">To test it out, you can follow these steps:</span></span>

1. <span data-ttu-id="c84ac-154">Sul dispositivo HoloLens 1 - Sposta Rover Explorer (Esplora Rover) nella posizione desiderata.</span><span class="sxs-lookup"><span data-stu-id="c84ac-154">On HoloLens device 1: Move the Rover Explorer to the desired location.</span></span>
2. <span data-ttu-id="c84ac-155">Sul dispositivo HoloLens 1 - Avvia la sessione di Azure.</span><span class="sxs-lookup"><span data-stu-id="c84ac-155">On HoloLens device 1: Start Azure Session.</span></span>
3. <span data-ttu-id="c84ac-156">Sul dispositivo HoloLens 1 - Crea l'ancoraggio di Azure. Gli ancoraggi vengono creati nella posizione di Rover Explorer (Esplora Rover).</span><span class="sxs-lookup"><span data-stu-id="c84ac-156">On HoloLens device 1: Create Azure Anchor (creates anchors at the location of the Rover Explorer).</span></span>
4. <span data-ttu-id="c84ac-157">Sul dispositivo HoloLens 1 - Condividi l'ID ancoraggio di Azure sulla rete.</span><span class="sxs-lookup"><span data-stu-id="c84ac-157">On HoloLens device 1: Share Azure Anchor ID to Network.</span></span>
5. <span data-ttu-id="c84ac-158">Sul dispositivo HoloLens 2 - Avvia l'app.</span><span class="sxs-lookup"><span data-stu-id="c84ac-158">On HoloLens device 2: Start the app.</span></span>
6. <span data-ttu-id="c84ac-159">Sul dispositivo HoloLens 2 - Ottieni l'ID ancoraggio condiviso dalla rete. Dal dispositivo HoloLens 1 viene recuperato l'ID ancoraggio appena condiviso.</span><span class="sxs-lookup"><span data-stu-id="c84ac-159">On HoloLens device 2: Get Shared Anchor ID from Network (fetches the anchor ID just shared from HoloLens device 1).</span></span>
7. <span data-ttu-id="c84ac-160">Sul dispositivo HoloLens 2 - Avvia la sessione di Azure.</span><span class="sxs-lookup"><span data-stu-id="c84ac-160">On HoloLens device 2: Start Azure Session.</span></span>
8. <span data-ttu-id="c84ac-161">Sul dispositivo HoloLens 2 - Trova l'ancoraggio di Azure. L'esperienza Rover Explorer (Esplora Rover) viene collocata nella posizione del passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="c84ac-161">On HoloLens device 2: Find Azure Anchor (positions the Rover Explorer at the location from step 3).</span></span>

> [!TIP]
> <span data-ttu-id="c84ac-162">Se è presente un solo dispositivo HoloLens, puoi comunque testare la funzionalità riavviando l'app invece di usare un secondo dispositivo HoloLens.</span><span class="sxs-lookup"><span data-stu-id="c84ac-162">If you only have one HoloLens, you can still test the functionality by restarting the app instead of using a second HoloLens device.</span></span>

## <a name="congratulations"></a><span data-ttu-id="c84ac-163">Lezione completata</span><span class="sxs-lookup"><span data-stu-id="c84ac-163">Congratulations</span></span>

<span data-ttu-id="c84ac-164">In questa esercitazione hai appreso come mantenere gli ancoraggi nello spazio di Azure tra una sessione e l'altra e un riavvio e l'altro dell'app salvando l'ID ancoraggio nello spazio di Azure sul disco locale di HoloLens.</span><span class="sxs-lookup"><span data-stu-id="c84ac-164">In this tutorial, you learned how to persist Azure Spatial Anchors between app sessions and app restarts by saving the Azure Spatial Anchor ID to the local disk on HoloLens.</span></span> <span data-ttu-id="c84ac-165">Hai anche appreso come condividere gli ancoraggi nello spazio di Azure tra più dispositivi per un'esperienza condivisa di base multiutente con ologrammi statici.</span><span class="sxs-lookup"><span data-stu-id="c84ac-165">You also learned how to share Azure Spatial Anchors between multiple devices for a basic multi-user, static hologram shared experience.</span></span>

<span data-ttu-id="c84ac-166">Nell'esercitazione successiva apprenderai come fornire agli utenti il feedback in tempo reale.</span><span class="sxs-lookup"><span data-stu-id="c84ac-166">In the next tutorial, you will learn how to provide users with real-time feedback.</span></span> <span data-ttu-id="c84ac-167">Questo feedback includerà informazioni sulla creazione degli ancoraggi, sulla qualità della comprensione dell'ambiente e sullo stato della sessione di Azure.</span><span class="sxs-lookup"><span data-stu-id="c84ac-167">This feedback will include information about Anchor creation, the quality of environment understanding, and the Azure session's state.</span></span> <span data-ttu-id="c84ac-168">Senza feedback, gli utenti potrebbero non sapere se un ancoraggio è stato caricato correttamente in Azure, se la qualità dell'ambiente è sufficiente per la creazione degli ancoraggi o quale sia lo stato corrente.</span><span class="sxs-lookup"><span data-stu-id="c84ac-168">Without feedback, users may not know whether an anchor has successfully been uploaded to Azure, whether the quality of the environment is sufficient for anchor creation, or the current state.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="c84ac-169">Esercitazione successiva: 4. Visualizzazione del feedback su Ancoraggi nello spazio di Azure</span><span class="sxs-lookup"><span data-stu-id="c84ac-169">Next Tutorial: 4. Displaying Azure Spatial Anchor feedback</span></span>](mr-learning-asa-04.md)
