---
title: MR sharing 250-HoloLens e auricolari immersivi
description: Seguire questa procedura dettagliata di codifica usando Unity, Visual Studio, HoloLens e gli auricolari per la realtà mista di Windows per apprendere i dettagli della condivisione degli ologrammi tra i dispositivi a realtà mista.
author: keveleigh
ms.author: kurtie
ms.date: 10/22/2019
ms.topic: article
keywords: holotoolkit, mixedrealitytoolkit, mixedrealitytoolkit-Unity, immersive, Motion controller, condivisione, Xbox Controller, rete, dispositivo incrociato
ms.openlocfilehash: a980441ee73cd8f45afff446d9315eaf08549575
ms.sourcegitcommit: 09599b4034be825e4536eeb9566968afd021d5f3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/03/2020
ms.locfileid: "91685332"
---
# <a name="mr-sharing-250-hololens-and-immersive-headsets"></a><span data-ttu-id="38649-104">Condivisione MR 250: HoloLens e visori VR immersivi</span><span class="sxs-lookup"><span data-stu-id="38649-104">MR Sharing 250: HoloLens and immersive headsets</span></span>

>[!NOTE]
><span data-ttu-id="38649-105">Le esercitazioni di Mixed Reality Academy sono state progettate in base a HoloLens (prima generazione) e ai visori VR immersive di realtà mista.</span><span class="sxs-lookup"><span data-stu-id="38649-105">The Mixed Reality Academy tutorials were designed with HoloLens (1st gen) and Mixed Reality Immersive Headsets in mind.</span></span>  <span data-ttu-id="38649-106">Pertanto, riteniamo importante lasciarle a disposizione degli sviluppatori a cui serve ancora materiale sussidiario per lo sviluppo di questi dispositivi.</span><span class="sxs-lookup"><span data-stu-id="38649-106">As such, we feel it is important to leave these tutorials in place for developers who are still looking for guidance in developing for those devices.</span></span>  <span data-ttu-id="38649-107">Queste esercitazioni **_non_** verranno aggiornate con i set di strumenti o le interazioni più recenti usati per HoloLens 2.</span><span class="sxs-lookup"><span data-stu-id="38649-107">These tutorials will **_not_** be updated with the latest toolsets or interactions being used for HoloLens 2.</span></span>  <span data-ttu-id="38649-108">Rimarranno invariate per consentire di continuare a lavorare sui dispositivi supportati.</span><span class="sxs-lookup"><span data-stu-id="38649-108">They will be maintained to continue working on the supported devices.</span></span> <span data-ttu-id="38649-109">Per HoloLens 2 è stata pubblicata [una nuova serie di esercitazioni](../mr-learning-base-01.md).</span><span class="sxs-lookup"><span data-stu-id="38649-109">[A new series of tutorials](../mr-learning-base-01.md) has been posted for HoloLens 2.</span></span>

<span data-ttu-id="38649-110">Con la flessibilità di piattaforma UWP (Universal Windows Platform) (UWP), è facile creare un'applicazione che si estende su più dispositivi.</span><span class="sxs-lookup"><span data-stu-id="38649-110">With the flexibility of Universal Windows Platform (UWP), it is easy to create an application that spans multiple devices.</span></span> <span data-ttu-id="38649-111">Grazie a questa flessibilità, possiamo creare esperienze che sfruttano i punti di forza di ogni dispositivo.</span><span class="sxs-lookup"><span data-stu-id="38649-111">With this flexibility, we can create experiences that leverage the strengths of each device.</span></span> <span data-ttu-id="38649-112">In questa esercitazione verrà illustrata un'esperienza condivisa di base che viene eseguita sia in HoloLens che in modalità mista di Windows.</span><span class="sxs-lookup"><span data-stu-id="38649-112">This tutorial will cover a basic shared experience that runs on both HoloLens and Windows Mixed Reality immersive headsets.</span></span> <span data-ttu-id="38649-113">Questo contenuto è stato originariamente fornito alla conferenza Microsoft Build 2017 a Seattle, WA.</span><span class="sxs-lookup"><span data-stu-id="38649-113">This content was originally delivered at the Microsoft Build 2017 conference in Seattle, WA.</span></span>

<span data-ttu-id="38649-114">**In questa esercitazione si apprenderà come:**</span><span class="sxs-lookup"><span data-stu-id="38649-114">**In this tutorial, we will:**</span></span>

* <span data-ttu-id="38649-115">Configurare una rete usando UNET.</span><span class="sxs-lookup"><span data-stu-id="38649-115">Setup a network using UNET.</span></span>
* <span data-ttu-id="38649-116">Condividere gli ologrammi tra i dispositivi a realtà mista.</span><span class="sxs-lookup"><span data-stu-id="38649-116">Share holograms across mixed reality devices.</span></span>
* <span data-ttu-id="38649-117">Definire una visualizzazione diversa dell'applicazione a seconda del dispositivo di realtà mista utilizzato.</span><span class="sxs-lookup"><span data-stu-id="38649-117">Establish a different view of the application depending on which mixed reality device is being used.</span></span>
* <span data-ttu-id="38649-118">Crea un'esperienza condivisa in cui gli utenti di HoloLens guidano gli utenti con auricolari immersivi attraverso alcuni semplici puzzle.</span><span class="sxs-lookup"><span data-stu-id="38649-118">Create a shared experience where HoloLens users guide immersive headsets users through some simple puzzles.</span></span>

## <a name="device-support"></a><span data-ttu-id="38649-119">Supporto di dispositivi</span><span class="sxs-lookup"><span data-stu-id="38649-119">Device support</span></span>

<table>
<tr>
<th><span data-ttu-id="38649-120">Corso</span><span class="sxs-lookup"><span data-stu-id="38649-120">Course</span></span></th><th style="width:150px"> <span data-ttu-id="38649-121"><a href="../hololens-hardware-details.md">HoloLens</a></span><span class="sxs-lookup"><span data-stu-id="38649-121"><a href="../hololens-hardware-details.md">HoloLens</a></span></span></th><th style="width:150px"> <span data-ttu-id="38649-122"><a href="../discover/immersive-headset-hardware-details.md">Visori VR immersive</a></span><span class="sxs-lookup"><span data-stu-id="38649-122"><a href="../discover/immersive-headset-hardware-details.md">Immersive headsets</a></span></span></th>
</tr><tr>
<td><span data-ttu-id="38649-123">Condivisione MR 250: HoloLens e visori VR immersivi</span><span class="sxs-lookup"><span data-stu-id="38649-123">MR Sharing 250: HoloLens and immersive headsets</span></span></td><td style="text-align: center;"> <span data-ttu-id="38649-124">✔️</span><span class="sxs-lookup"><span data-stu-id="38649-124">✔️</span></span></td><td style="text-align: center;"> <span data-ttu-id="38649-125">✔️</span><span class="sxs-lookup"><span data-stu-id="38649-125">✔️</span></span></td>
</tr>
</table>

## <a name="before-you-start"></a><span data-ttu-id="38649-126">Prima di iniziare</span><span class="sxs-lookup"><span data-stu-id="38649-126">Before you start</span></span>

### <a name="prerequisites"></a><span data-ttu-id="38649-127">Prerequisiti</span><span class="sxs-lookup"><span data-stu-id="38649-127">Prerequisites</span></span>

* <span data-ttu-id="38649-128">Un PC Windows 10 con gli [strumenti di sviluppo necessari](../develop/install-the-tools.md) e [configurato per il supporto di una cuffia a realtà mista di Windows](https://docs.microsoft.com/windows/mixed-reality/enthusiast-guide/windows-mixed-reality-minimum-pc-hardware-compatibility-guidelines).</span><span class="sxs-lookup"><span data-stu-id="38649-128">A Windows 10 PC with the [necessary development tools](../develop/install-the-tools.md) and [configured to support a Windows Mixed Reality immersive headset](https://docs.microsoft.com/windows/mixed-reality/enthusiast-guide/windows-mixed-reality-minimum-pc-hardware-compatibility-guidelines).</span></span>
* <span data-ttu-id="38649-129">Controller Xbox che funziona con il PC.</span><span class="sxs-lookup"><span data-stu-id="38649-129">An Xbox controller that works with your PC.</span></span>
* <span data-ttu-id="38649-130">Almeno un dispositivo HoloLens e un headset immersivo.</span><span class="sxs-lookup"><span data-stu-id="38649-130">At least one HoloLens device and one immersive headset.</span></span>
* <span data-ttu-id="38649-131">Rete che consente la trasmissione UDP per l'individuazione.</span><span class="sxs-lookup"><span data-stu-id="38649-131">A network which allows UDP Broadcast for discovery.</span></span>

### <a name="project-files"></a><span data-ttu-id="38649-132">File di progetto</span><span class="sxs-lookup"><span data-stu-id="38649-132">Project files</span></span>

* <span data-ttu-id="38649-133">Scaricare i [file](https://github.com/Microsoft/MixedReality250/archive/master.zip) richiesti dal progetto.</span><span class="sxs-lookup"><span data-stu-id="38649-133">Download the [files](https://github.com/Microsoft/MixedReality250/archive/master.zip) required by the project.</span></span> <span data-ttu-id="38649-134">Estrarre i file in un percorso facile da ricordare.</span><span class="sxs-lookup"><span data-stu-id="38649-134">Extract the files to an easy to remember location.</span></span>
* <span data-ttu-id="38649-135">Questo progetto richiede [una versione consigliata di Unity con supporto della realtà mista di Windows](../develop/install-the-tools.md).</span><span class="sxs-lookup"><span data-stu-id="38649-135">This project requires the [a recommended version of Unity with Windows Mixed Reality support](../develop/install-the-tools.md).</span></span>

>[!NOTE]
><span data-ttu-id="38649-136">Se si vuole esaminare il codice sorgente prima del download, è [disponibile in GitHub](https://github.com/Microsoft/MixedReality250).</span><span class="sxs-lookup"><span data-stu-id="38649-136">If you want to look through the source code before downloading, it's [available on GitHub](https://github.com/Microsoft/MixedReality250).</span></span>

## <a name="chapter-1---holo-world"></a><span data-ttu-id="38649-137">Capitolo 1-Holo World</span><span class="sxs-lookup"><span data-stu-id="38649-137">Chapter 1 - Holo World</span></span>

>[!VIDEO https://www.youtube.com/embed/IC0rp6rLiEc]

### <a name="objectives"></a><span data-ttu-id="38649-138">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="38649-138">Objectives</span></span>

<span data-ttu-id="38649-139">Assicurarsi che l'ambiente di sviluppo sia pronto per l'uso con un progetto semplice.</span><span class="sxs-lookup"><span data-stu-id="38649-139">Make sure the development environment is ready to go with a simple project.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="38649-140">Elementi da compilare</span><span class="sxs-lookup"><span data-stu-id="38649-140">What we will build</span></span>

<span data-ttu-id="38649-141">Un'applicazione che mostra un ologramma in HoloLens o in un headset a realtà mista di Windows.</span><span class="sxs-lookup"><span data-stu-id="38649-141">An application that shows a hologram on either HoloLens or a Windows Mixed Reality immersive headset.</span></span>

### <a name="steps"></a><span data-ttu-id="38649-142">Passaggi</span><span class="sxs-lookup"><span data-stu-id="38649-142">Steps</span></span>

* <span data-ttu-id="38649-143">Aprire Unity.</span><span class="sxs-lookup"><span data-stu-id="38649-143">Open Unity.</span></span>
    * <span data-ttu-id="38649-144">Selezionare **Open** (Apri).</span><span class="sxs-lookup"><span data-stu-id="38649-144">Select **Open** .</span></span>
    * <span data-ttu-id="38649-145">Passare alla posizione in cui sono stati estratti i file di progetto.</span><span class="sxs-lookup"><span data-stu-id="38649-145">Navigate to where you extracted the project files.</span></span>
    * <span data-ttu-id="38649-146">Fare clic su **Seleziona cartella** .</span><span class="sxs-lookup"><span data-stu-id="38649-146">Click **Select Folder** .</span></span>
    * <span data-ttu-id="38649-147">*L'elaborazione del progetto da parte di Unity verrà eseguita per la prima volta.*</span><span class="sxs-lookup"><span data-stu-id="38649-147">*It will take a little while for Unity to process the project the first time.*</span></span>
* <span data-ttu-id="38649-148">Verificare che la realtà mista sia abilitata in Unity.</span><span class="sxs-lookup"><span data-stu-id="38649-148">Check that Mixed Reality is enabled in Unity.</span></span>
    * <span data-ttu-id="38649-149">Aprire la finestra di dialogo Impostazioni di compilazione ( **CTRL + MAIUSC + B** o **file > impostazioni di compilazione...** ).</span><span class="sxs-lookup"><span data-stu-id="38649-149">Open the build settings dialog ( **Control+Shift+B** or **File > Build Settings...** ).</span></span>
    * <span data-ttu-id="38649-150">Selezionare **piattaforma UWP (Universal Windows Platform)** quindi fare clic su **Cambia piattaforma** .</span><span class="sxs-lookup"><span data-stu-id="38649-150">Select **Universal Windows Platform** then click **Switch Platform** .</span></span>
    * <span data-ttu-id="38649-151">Selezionare **Modifica impostazioni lettore>** .</span><span class="sxs-lookup"><span data-stu-id="38649-151">Select **Edit>Player Settings** .</span></span>
    * <span data-ttu-id="38649-152">Nel pannello **Inspector** sul lato destro, espandere **XR Settings** .</span><span class="sxs-lookup"><span data-stu-id="38649-152">In the **Inspector** panel on the right hand side, expand **XR Settings** .</span></span>
    * <span data-ttu-id="38649-153">Controllare la casella **Virtual Reality supported** .</span><span class="sxs-lookup"><span data-stu-id="38649-153">Check the **Virtual Reality Supported** box.</span></span>
    * <span data-ttu-id="38649-154">*La realtà mista di Windows dovrebbe essere Virtual Reality SDK.*</span><span class="sxs-lookup"><span data-stu-id="38649-154">*Windows Mixed Reality should be the Virtual Reality SDK.*</span></span>
* <span data-ttu-id="38649-155">Creare una scena.</span><span class="sxs-lookup"><span data-stu-id="38649-155">Create a scene.</span></span>
    * <span data-ttu-id="38649-156">Nella **gerarchia** fare clic su **fotocamera principale** Selezionare **Elimina** .</span><span class="sxs-lookup"><span data-stu-id="38649-156">In the **Hierarchy** right click **Main Camera** select **Delete** .</span></span>
    * <span data-ttu-id="38649-157">Da **HoloToolkit > Input > i prefabbricati** trascinano **MixedRealityCameraParent** nella **gerarchia** .</span><span class="sxs-lookup"><span data-stu-id="38649-157">From **HoloToolkit > Input > Prefabs** drag **MixedRealityCameraParent** to the **Hierarchy** .</span></span>
* <span data-ttu-id="38649-158">Aggiungere ologrammi alla scena</span><span class="sxs-lookup"><span data-stu-id="38649-158">Add Holograms to the scene</span></span>
    * <span data-ttu-id="38649-159">Da **AppPrefabs** trascinare **SKYBOX** nella **visualizzazione scena** .</span><span class="sxs-lookup"><span data-stu-id="38649-159">From **AppPrefabs** drag **Skybox** to the **Scene View** .</span></span>
    * <span data-ttu-id="38649-160">Da **AppPrefabs** trascinare i **Manager** alla **gerarchia** .</span><span class="sxs-lookup"><span data-stu-id="38649-160">From **AppPrefabs** drag **Managers** to the **Hierarchy** .</span></span>
    * <span data-ttu-id="38649-161">Da **AppPrefabs** trascinare l' **isola** nella **gerarchia** .</span><span class="sxs-lookup"><span data-stu-id="38649-161">From **AppPrefabs** drag **Island** to the **Hierarchy** .</span></span>
* <span data-ttu-id="38649-162">Salva e compila</span><span class="sxs-lookup"><span data-stu-id="38649-162">Save And build</span></span>
    * <span data-ttu-id="38649-163">Salva ( **CTRL + S** o **file > Salva scena** )</span><span class="sxs-lookup"><span data-stu-id="38649-163">Save (either **Control+S** or **File > Save Scene** )</span></span>
    * <span data-ttu-id="38649-164">Poiché si tratta di una nuova scena, è necessario assegnarle un nome.</span><span class="sxs-lookup"><span data-stu-id="38649-164">Since this is a new scene, you'll need to name it.</span></span> <span data-ttu-id="38649-165">Il nome non è rilevante, ma viene usato SharedMixedReality.</span><span class="sxs-lookup"><span data-stu-id="38649-165">Name doesn't matter, but we use SharedMixedReality.</span></span>
* <span data-ttu-id="38649-166">Esporta in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="38649-166">Export To Visual Studio</span></span>
    * <span data-ttu-id="38649-167">Aprire il menu Compila ( **CTRL + MAIUSC + B** o **file > impostazioni di compilazione** )</span><span class="sxs-lookup"><span data-stu-id="38649-167">Open the build menu ( **Control+Shift+B** or **File > Build Settings** )</span></span>
    * <span data-ttu-id="38649-168">Fare clic su **Aggiungi scene aperte.**</span><span class="sxs-lookup"><span data-stu-id="38649-168">Click **Add Open Scenes.**</span></span>
    * <span data-ttu-id="38649-169">Verifica **progetti C# Unity**</span><span class="sxs-lookup"><span data-stu-id="38649-169">Check **Unity C# Projects**</span></span>
    * <span data-ttu-id="38649-170">Fare clic su **Compila** .</span><span class="sxs-lookup"><span data-stu-id="38649-170">Click **Build** .</span></span>
    * <span data-ttu-id="38649-171">Nella finestra Esplora file visualizzata creare una nuova cartella denominata **app** .</span><span class="sxs-lookup"><span data-stu-id="38649-171">In the file explorer window that appears, create a New Folder named **App** .</span></span>
    * <span data-ttu-id="38649-172">Fare clic sulla cartella dell' **app** .</span><span class="sxs-lookup"><span data-stu-id="38649-172">Single click the **App** folder.</span></span>
    * <span data-ttu-id="38649-173">Premere **Seleziona cartella.**</span><span class="sxs-lookup"><span data-stu-id="38649-173">Press **Select Folder.**</span></span>
    * <span data-ttu-id="38649-174">**Attendi il completamento della compilazione**</span><span class="sxs-lookup"><span data-stu-id="38649-174">**Wait for the build to complete**</span></span>
    * <span data-ttu-id="38649-175">Nella finestra Esplora file visualizzata passare alla cartella **app** .</span><span class="sxs-lookup"><span data-stu-id="38649-175">In the file explorer window that appears, navigate into the **App** folder.</span></span>
    * <span data-ttu-id="38649-176">Fare doppio clic su **SharedMixedReality. sln** per avviare Visual Studio</span><span class="sxs-lookup"><span data-stu-id="38649-176">Double-click **SharedMixedReality.sln** to launch Visual Studio</span></span>
* <span data-ttu-id="38649-177">Compilazione da Visual Studio</span><span class="sxs-lookup"><span data-stu-id="38649-177">Build From Visual Studio</span></span>
    * <span data-ttu-id="38649-178">Utilizzando la barra degli strumenti superiore modificare destinazione per **rilasciare** e **x86** .</span><span class="sxs-lookup"><span data-stu-id="38649-178">Using the top toolbar change target to **Release** and **x86** .</span></span>
    * <span data-ttu-id="38649-179">Fare clic sulla freccia accanto a **computer locale** e selezionare il **dispositivo** da distribuire in HoloLens</span><span class="sxs-lookup"><span data-stu-id="38649-179">Click the arrow next to **Local Machine** and select **Device** to deploy to HoloLens</span></span>
    * <span data-ttu-id="38649-180">Fare clic sulla freccia accanto a **dispositivo** e selezionare **computer locale** per eseguire la distribuzione per l'auricolare della realtà mista.</span><span class="sxs-lookup"><span data-stu-id="38649-180">Click the arrow next to **Device** and select **Local Machine** to deploy for the mixed reality headset.</span></span>
    * <span data-ttu-id="38649-181">Fare clic su **debug->avvia senza eseguire debug** o **CTRL + F5** per avviare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="38649-181">Click **Debug->Start Without Debugging** or **Control+F5** to start the application.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="38649-182">Ricerche nel codice</span><span class="sxs-lookup"><span data-stu-id="38649-182">Digging into the code</span></span>

<span data-ttu-id="38649-183">Nel pannello del progetto passare a **Assets\HoloToolkit\Input\Scripts\Utilities** e fare doppio clic su **MixedRealityCameraManager.cs** per aprirlo.</span><span class="sxs-lookup"><span data-stu-id="38649-183">In the project panel, navigate to **Assets\HoloToolkit\Input\Scripts\Utilities** and double click **MixedRealityCameraManager.cs** to open it.</span></span>

<span data-ttu-id="38649-184">**Panoramica:** MixedRealityCameraManager.cs è un semplice script che regola il livello di qualità e le impostazioni di sfondo in base al dispositivo.</span><span class="sxs-lookup"><span data-stu-id="38649-184">**Overview:** MixedRealityCameraManager.cs is a simple script that adjusts quality level and background settings based on the device.</span></span> <span data-ttu-id="38649-185">La chiave è HolographicSettings. IsDisplayOpaque, che consente a uno script di rilevare se il dispositivo è un HoloLens (IsDisplayOpaque restituisce false) o un auricolare immersivo (IsDisplayOpaque restituisce true).</span><span class="sxs-lookup"><span data-stu-id="38649-185">Key here is HolographicSettings.IsDisplayOpaque, which allows a script to detect if the device is a HoloLens (IsDisplayOpaque returns false) or an immersive headset (IsDisplayOpaque returns true).</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="38649-186">Scopri lo stato di avanzamento</span><span class="sxs-lookup"><span data-stu-id="38649-186">Enjoy your progress</span></span>

<span data-ttu-id="38649-187">A questo punto, l'applicazione eseguirà semplicemente il rendering di un ologramma.</span><span class="sxs-lookup"><span data-stu-id="38649-187">At this point the application will just render a hologram.</span></span> <span data-ttu-id="38649-188">L'interazione con l'ologramma viene aggiunta in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="38649-188">We will add interaction to the hologram later.</span></span> <span data-ttu-id="38649-189">Entrambi i dispositivi eseguiranno il rendering dell'ologramma.</span><span class="sxs-lookup"><span data-stu-id="38649-189">Both devices will render the hologram the same.</span></span> <span data-ttu-id="38649-190">L'auricolare immersivo eseguirà anche il rendering di un cielo blu e di uno sfondo cloud.</span><span class="sxs-lookup"><span data-stu-id="38649-190">The immersive headset will also render a blue sky and clouds background.</span></span>

## <a name="chapter-2---interaction"></a><span data-ttu-id="38649-191">Capitolo 2-interazione</span><span class="sxs-lookup"><span data-stu-id="38649-191">Chapter 2 - Interaction</span></span>

>[!VIDEO https://www.youtube.com/embed/Lrb1y4sQRvI]

### <a name="objectives"></a><span data-ttu-id="38649-192">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="38649-192">Objectives</span></span>

<span data-ttu-id="38649-193">Mostra come gestire l'input per un'applicazione di realtà mista di Windows.</span><span class="sxs-lookup"><span data-stu-id="38649-193">Show how to handle input for a Windows Mixed Reality application.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="38649-194">Elementi da compilare</span><span class="sxs-lookup"><span data-stu-id="38649-194">What we will build</span></span>

<span data-ttu-id="38649-195">Basandosi sull'applicazione del capitolo 1, si aggiungeranno funzionalità per consentire all'utente di prelevare l'ologramma e posizionarlo in una superficie reale in HoloLens o in una tabella virtuale in un auricolare immersivo.</span><span class="sxs-lookup"><span data-stu-id="38649-195">Building on the application from chapter 1, we will add functionality to allow the user to pick up the hologram and place it on a real world surface in HoloLens or on a virtual table in an immersive headset.</span></span>

<span data-ttu-id="38649-196">**Aggiornamento dell'input:** In HoloLens il gesto di selezione è il **tocco d'aria** .</span><span class="sxs-lookup"><span data-stu-id="38649-196">**Input Refresher:** On HoloLens the select gesture is the **air tap** .</span></span> <span data-ttu-id="38649-197">Negli auricolari immersivi viene usato il pulsante **a** del controller Xbox.</span><span class="sxs-lookup"><span data-stu-id="38649-197">On immersive headsets, we will use the **A** button on the Xbox controller.</span></span> <span data-ttu-id="38649-198">Per altre informazioni, vedere [Panoramica del modello di interazione](../design/interaction-fundamentals.md).</span><span class="sxs-lookup"><span data-stu-id="38649-198">For more information check out the [interaction model overview](../design/interaction-fundamentals.md).</span></span>

### <a name="steps"></a><span data-ttu-id="38649-199">Passaggi</span><span class="sxs-lookup"><span data-stu-id="38649-199">Steps</span></span>

* <span data-ttu-id="38649-200">Aggiunta di gestione input</span><span class="sxs-lookup"><span data-stu-id="38649-200">Add Input manager</span></span>
    * <span data-ttu-id="38649-201">Da **HoloToolkit > Input > i prefabbricati** trascinano **InputManager** nella **gerarchia** come figlio dei **responsabili** .</span><span class="sxs-lookup"><span data-stu-id="38649-201">From **HoloToolkit > Input > Prefabs** drag **InputManager** to **Hierarchy** as a child of **Managers** .</span></span>
    * <span data-ttu-id="38649-202">Da **HoloToolkit > Input > Prefabbricati >** cursore **di** trascinamento cursore alla **gerarchia** .</span><span class="sxs-lookup"><span data-stu-id="38649-202">From **HoloToolkit > Input > Prefabs > Cursor** drag **Cursor** to **Hierarchy** .</span></span>
* <span data-ttu-id="38649-203">Aggiungi mapping spaziale</span><span class="sxs-lookup"><span data-stu-id="38649-203">Add Spatial Mapping</span></span>
    * <span data-ttu-id="38649-204">Da **HoloToolkit > SpatialMapping > i prefabbricati** trascinano **SpatialMapping** nella **gerarchia** .</span><span class="sxs-lookup"><span data-stu-id="38649-204">From **HoloToolkit > SpatialMapping > Prefabs** drag **SpatialMapping** to **Hierarchy** .</span></span>
* <span data-ttu-id="38649-205">Aggiungi playspace virtuale</span><span class="sxs-lookup"><span data-stu-id="38649-205">Add Virtual Playspace</span></span>
    * <span data-ttu-id="38649-206">In **gerarchia** Espandi **MixedRealityCameraParent** Selezionare **limite**</span><span class="sxs-lookup"><span data-stu-id="38649-206">In **Hierarchy** expand **MixedRealityCameraParent** select **Boundary**</span></span>
    * <span data-ttu-id="38649-207">Nel pannello **Inspector** selezionare la casella per abilitare il **limite**</span><span class="sxs-lookup"><span data-stu-id="38649-207">In **Inspector** panel check the box to enable **Boundary**</span></span>
    * <span data-ttu-id="38649-208">Da **AppPrefabs** trascinare **VRRoom** in **gerarchia** .</span><span class="sxs-lookup"><span data-stu-id="38649-208">From **AppPrefabs** drag **VRRoom** to **Hierarchy** .</span></span>
* <span data-ttu-id="38649-209">Aggiungi WorldAnchorManager</span><span class="sxs-lookup"><span data-stu-id="38649-209">Add WorldAnchorManager</span></span>
    * <span data-ttu-id="38649-210">In **gerarchia** selezionare **Manager** .</span><span class="sxs-lookup"><span data-stu-id="38649-210">In **Hierarchy** , Select **Managers** .</span></span>
    * <span data-ttu-id="38649-211">In **Inspector** fare clic su **Add Component** .</span><span class="sxs-lookup"><span data-stu-id="38649-211">In **Inspector** , click **Add Component** .</span></span>
    * <span data-ttu-id="38649-212">Digitare **World Anchor Manager** .</span><span class="sxs-lookup"><span data-stu-id="38649-212">Type **World Anchor Manager** .</span></span>
    * <span data-ttu-id="38649-213">Selezionare **World Anchor Manager** per aggiungerlo.</span><span class="sxs-lookup"><span data-stu-id="38649-213">Select **World Anchor Manager** to add it.</span></span>
* <span data-ttu-id="38649-214">Aggiungere TapToPlace all'isola</span><span class="sxs-lookup"><span data-stu-id="38649-214">Add TapToPlace to the Island</span></span>
    * <span data-ttu-id="38649-215">In **gerarchia** espandere **isola** .</span><span class="sxs-lookup"><span data-stu-id="38649-215">In **Hierarchy** , expand **Island** .</span></span>
    * <span data-ttu-id="38649-216">Selezionare **MixedRealityLand** .</span><span class="sxs-lookup"><span data-stu-id="38649-216">Select **MixedRealityLand** .</span></span>
    * <span data-ttu-id="38649-217">In **Inspector** fare clic su **Add Component** .</span><span class="sxs-lookup"><span data-stu-id="38649-217">In **Inspector** , click **Add Component** .</span></span>
    * <span data-ttu-id="38649-218">Digitare **Tap per posizionarlo** e selezionarlo.</span><span class="sxs-lookup"><span data-stu-id="38649-218">Type **Tap To Place** and select it.</span></span>
    * <span data-ttu-id="38649-219">Controllare la **posizione dell'elemento padre al tocco** .</span><span class="sxs-lookup"><span data-stu-id="38649-219">Check **Place Parent On Tap** .</span></span>
    * <span data-ttu-id="38649-220">Imposta **offset selezione host** su **(0, 0,1, 0)** .</span><span class="sxs-lookup"><span data-stu-id="38649-220">Set **Placement Offset** to **(0, 0.1, 0)** .</span></span>
* <span data-ttu-id="38649-221">Salva e compila come prima</span><span class="sxs-lookup"><span data-stu-id="38649-221">Save and Build as before</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="38649-222">Ricerche nel codice</span><span class="sxs-lookup"><span data-stu-id="38649-222">Digging into the code</span></span>

<span data-ttu-id="38649-223">**Script 1-GamepadInput.cs**</span><span class="sxs-lookup"><span data-stu-id="38649-223">**Script 1 - GamepadInput.cs**</span></span>

<span data-ttu-id="38649-224">Nel pannello del progetto passare a **Assets\HoloToolkit\Input\Scripts\InputSources** e fare doppio clic su **GamepadInput.cs** per aprirlo.</span><span class="sxs-lookup"><span data-stu-id="38649-224">In the project panel navigate to **Assets\HoloToolkit\Input\Scripts\InputSources** and double click **GamepadInput.cs** to open it.</span></span> <span data-ttu-id="38649-225">Dallo stesso percorso nel pannello del progetto, fare doppio clic su **InteractionSourceInputSource.cs** .</span><span class="sxs-lookup"><span data-stu-id="38649-225">From the same path in the project panel, also double click **InteractionSourceInputSource.cs** .</span></span>

<span data-ttu-id="38649-226">Si noti che entrambi gli script hanno una classe base comune, BaseInputSource.</span><span class="sxs-lookup"><span data-stu-id="38649-226">Note that both scripts have a common base class, BaseInputSource.</span></span>

<span data-ttu-id="38649-227">BaseInputSource mantiene un riferimento a un InputManager, che consente a uno script di attivare gli eventi.</span><span class="sxs-lookup"><span data-stu-id="38649-227">BaseInputSource keeps a reference to an InputManager, which allows a script to trigger events.</span></span> <span data-ttu-id="38649-228">In questo caso, l'evento InputClicked è pertinente.</span><span class="sxs-lookup"><span data-stu-id="38649-228">In this case, the InputClicked event is relevant.</span></span> <span data-ttu-id="38649-229">Questo aspetto è importante da ricordare quando si arriva allo script 2, TapToPlace.</span><span class="sxs-lookup"><span data-stu-id="38649-229">This will be important to remember when we get to script 2, TapToPlace.</span></span> <span data-ttu-id="38649-230">Nel caso di GamePadInput, viene eseguito il polling del pulsante a del controller da premere, quindi viene generato l'evento InputClicked.</span><span class="sxs-lookup"><span data-stu-id="38649-230">In the case of GamePadInput, we poll for the A button on the controller to be pressed, then we raise the InputClicked event.</span></span> <span data-ttu-id="38649-231">Nel caso di InteractionSourceInputSource, viene generato l'evento InputClicked in risposta a TappedEvent.</span><span class="sxs-lookup"><span data-stu-id="38649-231">In the case of InteractionSourceInputSource, we raise the InputClicked event in response to the TappedEvent.</span></span>

<span data-ttu-id="38649-232">**Script 2-TapToPlace.cs**</span><span class="sxs-lookup"><span data-stu-id="38649-232">**Script 2 - TapToPlace.cs**</span></span>

<span data-ttu-id="38649-233">Nel pannello del progetto passare a **Assets\HoloToolkit\SpatialMapping\Scripts** e fare doppio clic su **TapToPlace.cs** per aprirlo.</span><span class="sxs-lookup"><span data-stu-id="38649-233">In the project panel navigate to **Assets\HoloToolkit\SpatialMapping\Scripts** and double click **TapToPlace.cs** to open it.</span></span>

<span data-ttu-id="38649-234">La prima cosa che molti sviluppatori vogliono implementare quando si crea un'applicazione olografica consiste nello trasferire gli ologrammi con input di movimento.</span><span class="sxs-lookup"><span data-stu-id="38649-234">The first thing many developers want to implement when creating a Holographic application is moving Holograms with gesture input.</span></span> <span data-ttu-id="38649-235">Di conseguenza, abbiamo cercato di commentare questo script in modo approfondito.</span><span class="sxs-lookup"><span data-stu-id="38649-235">As such, we've endeavored to thoroughly comment this script.</span></span> <span data-ttu-id="38649-236">Per questa esercitazione è opportuno evidenziare alcuni aspetti.</span><span class="sxs-lookup"><span data-stu-id="38649-236">A few things are worth highlighting for this tutorial.</span></span>

<span data-ttu-id="38649-237">Si noti prima di tutto che TapToPlace implementa IInputClickHandler.</span><span class="sxs-lookup"><span data-stu-id="38649-237">First, note that TapToPlace implements IInputClickHandler.</span></span> <span data-ttu-id="38649-238">IInputClickHandler espone le funzioni che gestiscono l'evento InputClicked generato da GamePadInput.cs o InteractionSourceInputSource.cs.</span><span class="sxs-lookup"><span data-stu-id="38649-238">IInputClickHandler exposes the functions that handle the InputClicked event raised by GamePadInput.cs or InteractionSourceInputSource.cs.</span></span> <span data-ttu-id="38649-239">OnInputClicked viene chiamato quando un BaseInputSource rileva un clic mentre l'oggetto con TapToPlace si trova nello stato attivo.</span><span class="sxs-lookup"><span data-stu-id="38649-239">OnInputClicked is called when a BaseInputSource detects a click while the object with TapToPlace is in focus.</span></span> <span data-ttu-id="38649-240">L'evento viene attivato in HoloLens o premendo il pulsante a del controller Xbox.</span><span class="sxs-lookup"><span data-stu-id="38649-240">Either airtapping on HoloLens or pressing the A button on the Xbox controller will trigger the event.</span></span>

<span data-ttu-id="38649-241">In secondo luogo, il codice deve essere eseguito in Update per verificare se è in corso l'aspetto di una superficie, in modo da poter posizionare l'oggetto gioco su una superficie, ad esempio una tabella.</span><span class="sxs-lookup"><span data-stu-id="38649-241">Second is the code be executed in update to see if a surface is being looked at so we can place the game object on a surface, like a table.</span></span> <span data-ttu-id="38649-242">L'auricolare immersivo non ha un concetto di superficie reale, quindi l'oggetto che rappresenta la tabella Top (Vroom > TableThingy > Cube) è stato contrassegnato con il livello di fisica SpatialMapping, quindi il cast del raggio in Update entrerà in conflitto con la tabella virtuale top.</span><span class="sxs-lookup"><span data-stu-id="38649-242">The immersive headset doesn't have a concept of real surfaces, so the object that represents the table top (Vroom > TableThingy > Cube) has been marked with the SpatialMapping physics layer, so the ray cast in Update will collide with the virtual table top.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="38649-243">Scopri lo stato di avanzamento</span><span class="sxs-lookup"><span data-stu-id="38649-243">Enjoy your progress</span></span>

<span data-ttu-id="38649-244">Questa volta è possibile selezionare l'isola per spostarla.</span><span class="sxs-lookup"><span data-stu-id="38649-244">This time you can select the island to move it.</span></span> <span data-ttu-id="38649-245">In HoloLens è possibile spostare l'isola in una superficie reale.</span><span class="sxs-lookup"><span data-stu-id="38649-245">On HoloLens you can move the island to a real surface.</span></span> <span data-ttu-id="38649-246">Nel dispositivo headset immersivo è possibile spostare l'isola nella tabella virtuale aggiunta.</span><span class="sxs-lookup"><span data-stu-id="38649-246">In the immersive headset you can move the island to the virtual table we added.</span></span>

## <a name="chapter-3---sharing"></a><span data-ttu-id="38649-247">Capitolo 3-condivisione</span><span class="sxs-lookup"><span data-stu-id="38649-247">Chapter 3 - Sharing</span></span>

>[!VIDEO https://www.youtube.com/embed/1diycJvxfDc]

### <a name="objectives"></a><span data-ttu-id="38649-248">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="38649-248">Objectives</span></span>

<span data-ttu-id="38649-249">Verificare che la rete sia configurata correttamente e detaili la modalità di condivisione degli ancoraggi spaziali tra i dispositivi.</span><span class="sxs-lookup"><span data-stu-id="38649-249">Ensure that the network is correctly configured and detail how spatial anchors are shared between devices.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="38649-250">Elementi da compilare</span><span class="sxs-lookup"><span data-stu-id="38649-250">What we will build</span></span>

<span data-ttu-id="38649-251">Il progetto viene convertito in un progetto multiplayer.</span><span class="sxs-lookup"><span data-stu-id="38649-251">We will convert our project to a multiplayer project.</span></span> <span data-ttu-id="38649-252">Si aggiungeranno l'interfaccia utente e la logica alle sessioni host o join.</span><span class="sxs-lookup"><span data-stu-id="38649-252">We will add UI and logic to host or join sessions.</span></span> <span data-ttu-id="38649-253">Gli utenti di HoloLens si vedranno reciprocamente nella sessione con i cloud sulle rispettive e gli utenti di auricolari immersivi hanno un cloud vicino a quello in cui si trova l'ancoraggio.</span><span class="sxs-lookup"><span data-stu-id="38649-253">HoloLens users will see each other in the session with clouds over their heads, and immersive headset users have clouds near to where the anchor is.</span></span> <span data-ttu-id="38649-254">Gli utenti degli auricolari immersivi vedranno gli utenti di HoloLens relativi all'origine della scena.</span><span class="sxs-lookup"><span data-stu-id="38649-254">Users in the immersive headsets will see the HoloLens users relative to the origin of the scene.</span></span> <span data-ttu-id="38649-255">Gli utenti di HoloLens vedranno l'ologramma dell'isola nella stessa posizione.</span><span class="sxs-lookup"><span data-stu-id="38649-255">HoloLens users will all see the hologram of the island in the same place.</span></span> <span data-ttu-id="38649-256">Si noti che gli utenti negli auricolari immersivi non si troveranno nell'isola durante questo capitolo, ma si comporteranno in modo molto simile a HoloLens, con una vista degli uccelli dell'isola.</span><span class="sxs-lookup"><span data-stu-id="38649-256">It is key to note that the users in the immersive headsets will not be on the island during this chapter, but will behave very similarly to HoloLens, with a birds eye view of the island.</span></span>

### <a name="steps"></a><span data-ttu-id="38649-257">Passaggi</span><span class="sxs-lookup"><span data-stu-id="38649-257">Steps</span></span>

* <span data-ttu-id="38649-258">Rimuovi isola e VRRoom</span><span class="sxs-lookup"><span data-stu-id="38649-258">Remove Island and VRRoom</span></span>
    * <span data-ttu-id="38649-259">In **gerarchia** fare clic con il pulsante destro del mouse su **isola** Selezionare **Elimina**</span><span class="sxs-lookup"><span data-stu-id="38649-259">In **Hierarchy** right-click **Island** select **Delete**</span></span>
    * <span data-ttu-id="38649-260">In **gerarchia** fare clic con il pulsante destro del mouse su **VRRoom** Selezionare **Elimina**</span><span class="sxs-lookup"><span data-stu-id="38649-260">In **Hierarchy** right-click **VRRoom** select **Delete**</span></span>
* <span data-ttu-id="38649-261">Aggiungi usland</span><span class="sxs-lookup"><span data-stu-id="38649-261">Add Usland</span></span>
    * <span data-ttu-id="38649-262">Da **AppPrefabs** trascinare **usland** in **gerarchia** .</span><span class="sxs-lookup"><span data-stu-id="38649-262">From **AppPrefabs** drag **Usland** to **Hierarchy** .</span></span>
* <span data-ttu-id="38649-263">Da **AppPrefabs** trascinare ognuno dei seguenti elementi nella **gerarchia** :</span><span class="sxs-lookup"><span data-stu-id="38649-263">From **AppPrefabs** drag each of the following to **Hierarchy** :</span></span>
    * <span data-ttu-id="38649-264">**UNETSharingStage**</span><span class="sxs-lookup"><span data-stu-id="38649-264">**UNETSharingStage**</span></span>
    * <span data-ttu-id="38649-265">**UNetAnchorRoot**</span><span class="sxs-lookup"><span data-stu-id="38649-265">**UNetAnchorRoot**</span></span>
    * <span data-ttu-id="38649-266">**UIContainer**</span><span class="sxs-lookup"><span data-stu-id="38649-266">**UIContainer**</span></span>
    * <span data-ttu-id="38649-267">**DebugPanelButton**</span><span class="sxs-lookup"><span data-stu-id="38649-267">**DebugPanelButton**</span></span>
* <span data-ttu-id="38649-268">Salva e compila come prima</span><span class="sxs-lookup"><span data-stu-id="38649-268">Save and Build as before</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="38649-269">Ricerche nel codice</span><span class="sxs-lookup"><span data-stu-id="38649-269">Digging into the code</span></span>

<span data-ttu-id="38649-270">Nel pannello del progetto passare a **Assets\AppPrefabs\Support\SharingWithUnet\Scripts** e fare doppio clic su **UnetAnchorManager.cs** .</span><span class="sxs-lookup"><span data-stu-id="38649-270">In the project panel, navigate to **Assets\AppPrefabs\Support\SharingWithUnet\Scripts** and double-click on **UnetAnchorManager.cs** .</span></span> <span data-ttu-id="38649-271">La possibilità per un HoloLens di condividere le informazioni di rilevamento con un altro HoloLens, in modo che entrambi i dispositivi possano condividere lo stesso spazio è quasi magico.</span><span class="sxs-lookup"><span data-stu-id="38649-271">The ability for one HoloLens to share tracking information with another HoloLens such that both devices can share the same space is near magical.</span></span> <span data-ttu-id="38649-272">La potenza della realtà mista è attiva quando due o più persone possono collaborare usando gli stessi dati digitali.</span><span class="sxs-lookup"><span data-stu-id="38649-272">The power of mixed reality comes alive when two or more people can collaborate using the same digital data.</span></span>

<span data-ttu-id="38649-273">Ecco alcuni aspetti da evidenziare in questo script:</span><span class="sxs-lookup"><span data-stu-id="38649-273">A few things to point out in this script:</span></span>

<span data-ttu-id="38649-274">Nella funzione Start si noti il controllo **IsDisplayOpaque** .</span><span class="sxs-lookup"><span data-stu-id="38649-274">In the start function, notice the check for **IsDisplayOpaque** .</span></span> <span data-ttu-id="38649-275">In questo caso, si Finge che l'ancoraggio venga stabilito.</span><span class="sxs-lookup"><span data-stu-id="38649-275">In this case, we pretend that the Anchor is established.</span></span> <span data-ttu-id="38649-276">Questo perché gli auricolari immersivi non espongono un modo per importare o esportare ancoraggi.</span><span class="sxs-lookup"><span data-stu-id="38649-276">This is because the immersive headsets do not expose a way to import or export anchors.</span></span> <span data-ttu-id="38649-277">Se viene eseguito in un HoloLens, tuttavia, questo script implementa gli ancoraggi di condivisione tra i dispositivi.</span><span class="sxs-lookup"><span data-stu-id="38649-277">If we are running on a HoloLens, however, this script implements sharing anchors between the devices.</span></span> <span data-ttu-id="38649-278">Il dispositivo che avvia la sessione creerà un ancoraggio per l'esportazione.</span><span class="sxs-lookup"><span data-stu-id="38649-278">The device that starts the session will create an anchor for exporting.</span></span> <span data-ttu-id="38649-279">Il dispositivo che partecipa a una sessione richiede l'ancoraggio dal dispositivo che ha avviato la sessione.</span><span class="sxs-lookup"><span data-stu-id="38649-279">The device that joins a session will request the anchor from the device that started the session.</span></span>

<span data-ttu-id="38649-280">**Esportazione**</span><span class="sxs-lookup"><span data-stu-id="38649-280">**Exporting:**</span></span>

<span data-ttu-id="38649-281">Quando un utente crea una sessione, NetworkDiscoveryWithAnchors chiamerà la funzione UNETAnchorManagers CreateAnchor.</span><span class="sxs-lookup"><span data-stu-id="38649-281">When a user creates a session, NetworkDiscoveryWithAnchors will call UNETAnchorManagers CreateAnchor function.</span></span> <span data-ttu-id="38649-282">Seguiamo il flusso CreateAnchor.</span><span class="sxs-lookup"><span data-stu-id="38649-282">Let's follow CreateAnchor flow.</span></span>

<span data-ttu-id="38649-283">Si inizia con alcune pulizie, cancellando tutti i dati che potrebbero essere stati raccolti per gli ancoraggi precedenti.</span><span class="sxs-lookup"><span data-stu-id="38649-283">We start by doing some housekeeping, clearing out any data we may have collected for previous anchors.</span></span> <span data-ttu-id="38649-284">Viene quindi verificato se è presente un ancoraggio memorizzato nella cache da caricare.</span><span class="sxs-lookup"><span data-stu-id="38649-284">Then we check if there is a cached anchor to load.</span></span> <span data-ttu-id="38649-285">I dati di ancoraggio tendono a essere compresi tra 5 e 20 MB, quindi il riutilizzo degli ancoraggi memorizzati nella cache può ridurre la quantità di dati necessari per il trasferimento in rete.</span><span class="sxs-lookup"><span data-stu-id="38649-285">The anchor data tends to be between 5 and 20 MB, so reusing cached anchors can save on the amount of data we need to transfer over the network.</span></span> <span data-ttu-id="38649-286">Vedremo come funziona un po' più tardi.</span><span class="sxs-lookup"><span data-stu-id="38649-286">We'll see how this works a bit later.</span></span> <span data-ttu-id="38649-287">Anche se si sta riutilizzando l'ancoraggio, è necessario che i dati di ancoraggio siano pronti nel caso in cui un nuovo client si unisca senza l'ancoraggio.</span><span class="sxs-lookup"><span data-stu-id="38649-287">Even if we are reusing the anchor, we need to get the anchor data ready in case a new client joins that doesn't have the anchor.</span></span>

<span data-ttu-id="38649-288">Parlando di ottenere i dati di ancoraggio pronti, la classe WorldAnchorTransferBatch espone la funzionalità per preparare i dati di ancoraggio per l'invio a un altro dispositivo o applicazione e la funzionalità per importare i dati di ancoraggio.</span><span class="sxs-lookup"><span data-stu-id="38649-288">Speaking of getting the anchor data ready, the WorldAnchorTransferBatch class exposes the functionality to prepare anchor data for sending to another device or application and the functionality to import the anchor data.</span></span> <span data-ttu-id="38649-289">Poiché il percorso di esportazione è in corso, si aggiungerà l'ancoraggio a WorldAnchorTransferBatch e si chiamerà la funzione ExportAsync.</span><span class="sxs-lookup"><span data-stu-id="38649-289">Since we're on the export path, we will add our anchor to the WorldAnchorTransferBatch and call the ExportAsync function.</span></span> <span data-ttu-id="38649-290">ExportAsync chiamerà quindi il callback WriteBuffer mentre genera i dati per l'esportazione.</span><span class="sxs-lookup"><span data-stu-id="38649-290">ExportAsync will then call the WriteBuffer callback as it generates data for export.</span></span> <span data-ttu-id="38649-291">Quando tutti i dati sono stati esportati, viene chiamato ExportComplete.</span><span class="sxs-lookup"><span data-stu-id="38649-291">When all of the data has been exported ExportComplete will be called.</span></span> <span data-ttu-id="38649-292">In WriteBuffer il blocco di dati viene aggiunto a un elenco che viene mantenuto per l'esportazione.</span><span class="sxs-lookup"><span data-stu-id="38649-292">In WriteBuffer we add the chunk of data to a list we keep for exporting.</span></span> <span data-ttu-id="38649-293">In ExportComplete l'elenco viene convertito in una matrice.</span><span class="sxs-lookup"><span data-stu-id="38649-293">In ExportComplete we convert the list to an array.</span></span> <span data-ttu-id="38649-294">Viene anche impostata la variabile anchorName, che attiverà altri dispositivi per richiedere l'ancoraggio se non è disponibile.</span><span class="sxs-lookup"><span data-stu-id="38649-294">The AnchorName variable is also set, which will trigger other devices to request the anchor if they don't have it.</span></span>

<span data-ttu-id="38649-295">In alcuni casi l'ancoraggio non viene esportato o creerà così pochi dati che verranno riprovati.</span><span class="sxs-lookup"><span data-stu-id="38649-295">In some cases the anchor won't export or will create so little data that we will try again.</span></span> <span data-ttu-id="38649-296">Qui è sufficiente chiamare di nuovo CreateAnchor.</span><span class="sxs-lookup"><span data-stu-id="38649-296">Here we just call CreateAnchor again.</span></span>

<span data-ttu-id="38649-297">Una funzione finale nel percorso di esportazione è AnchorFoundRemotely.</span><span class="sxs-lookup"><span data-stu-id="38649-297">A final function in the export path is AnchorFoundRemotely.</span></span> <span data-ttu-id="38649-298">Quando un altro dispositivo trova l'ancoraggio, il dispositivo lo dirà all'host e l'host lo userà come segnale che l'ancoraggio è un "ancoraggio positivo" e può essere memorizzato nella cache.</span><span class="sxs-lookup"><span data-stu-id="38649-298">When another device finds the anchor, that device will tell the host, and the host will use that as a signal that the anchor is a "good anchor" and can be cached.</span></span>

<span data-ttu-id="38649-299">**Importazione**</span><span class="sxs-lookup"><span data-stu-id="38649-299">**Importing:**</span></span>

<span data-ttu-id="38649-300">Quando un HoloLens viene unito a una sessione, deve importare un ancoraggio.</span><span class="sxs-lookup"><span data-stu-id="38649-300">When a HoloLens joins a session, it needs to import an anchor.</span></span> <span data-ttu-id="38649-301">Nella funzione Update di UNETAnchorManager viene eseguito il polling di anchorName.</span><span class="sxs-lookup"><span data-stu-id="38649-301">In UNETAnchorManager's Update function, the AnchorName is polled.</span></span> <span data-ttu-id="38649-302">Quando il nome dell'ancoraggio viene modificato, inizia il processo di importazione.</span><span class="sxs-lookup"><span data-stu-id="38649-302">When the anchor name changes, the import process begins.</span></span> <span data-ttu-id="38649-303">Prima di tutto, si tenta di caricare l'ancoraggio con il nome specificato dall'archivio di ancoraggio locale.</span><span class="sxs-lookup"><span data-stu-id="38649-303">First, we try to load the anchor with the specified name from the local anchor store.</span></span> <span data-ttu-id="38649-304">Se è già presente, è possibile usarlo senza scaricare di nuovo i dati.</span><span class="sxs-lookup"><span data-stu-id="38649-304">If we already have it, we can use it without downloading the data again.</span></span> <span data-ttu-id="38649-305">Se non è disponibile, viene chiamato WaitForAnchor che avvierà il download.</span><span class="sxs-lookup"><span data-stu-id="38649-305">If we don't have it, then we call WaitForAnchor which will initiate the download.</span></span>

<span data-ttu-id="38649-306">Una volta completato il download, viene chiamato NetworkTransmitter_dataReadyEvent.</span><span class="sxs-lookup"><span data-stu-id="38649-306">When the download is completed, NetworkTransmitter_dataReadyEvent is called.</span></span> <span data-ttu-id="38649-307">Il ciclo di aggiornamento verrà segnalato per chiamare ImportAsync con i dati scaricati.</span><span class="sxs-lookup"><span data-stu-id="38649-307">This will signal the Update loop to call ImportAsync with the downloaded data.</span></span> <span data-ttu-id="38649-308">ImportAsync chiamerà ImportComplete al termine del processo di importazione.</span><span class="sxs-lookup"><span data-stu-id="38649-308">ImportAsync will call ImportComplete when the import process is complete.</span></span> <span data-ttu-id="38649-309">Se l'importazione ha esito positivo, l'ancoraggio verrà salvato nell'archivio locale del lettore.</span><span class="sxs-lookup"><span data-stu-id="38649-309">If the import is successful, the anchor will be saved in the local player store.</span></span> <span data-ttu-id="38649-310">PlayerController.cs esegue effettivamente la chiamata a AnchorFoundRemotely per consentire all'host di sapere che è stato stabilito un ancoraggio valido.</span><span class="sxs-lookup"><span data-stu-id="38649-310">PlayerController.cs actually makes the call to AnchorFoundRemotely to let the host know that a good anchor has been established.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="38649-311">Scopri lo stato di avanzamento</span><span class="sxs-lookup"><span data-stu-id="38649-311">Enjoy your progress</span></span>

<span data-ttu-id="38649-312">Questa volta un utente con un HoloLens ospiterà una sessione usando il pulsante **Avvia sessione** nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="38649-312">This time a user with a HoloLens will host a session using the **start session** button in the UI.</span></span> <span data-ttu-id="38649-313">Gli altri utenti, sia su HoloLens che su un headset immersivo, selezionano la sessione e quindi selezionano il pulsante **Unisci sessione** nell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="38649-313">Other users, both on HoloLens or an immersive headset, will select the session and then select the **join session** button in the UI.</span></span> <span data-ttu-id="38649-314">Se sono presenti più persone con dispositivi HoloLens, avranno i cloud rossi sulle rispettive teste.</span><span class="sxs-lookup"><span data-stu-id="38649-314">If you have multiple people with HoloLens devices, they will have red clouds over their heads.</span></span> <span data-ttu-id="38649-315">Ci sarà anche un cloud blu per ogni auricolare immersiva, ma i cloud blu non saranno sopra gli auricolari, perché gli auricolari non tentano di trovare lo stesso spazio delle coordinate globali dei dispositivi HoloLens.</span><span class="sxs-lookup"><span data-stu-id="38649-315">There will also be a blue cloud for each immersive headset, but the blue clouds will not be above the headsets, as the headsets are not trying to find the same world coordinate space as the HoloLens devices.</span></span>

<span data-ttu-id="38649-316">Questo punto del progetto è un'applicazione di condivisione contenuta; non esegue molte operazioni e può fungere da baseline.</span><span class="sxs-lookup"><span data-stu-id="38649-316">This point in the project is a contained sharing application; it doesn't do very much, and could act as a baseline.</span></span> <span data-ttu-id="38649-317">Nei prossimi capitoli si inizierà a creare un'esperienza per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="38649-317">In the next chapters, we will start building an experience for people to enjoy.</span></span> <span data-ttu-id="38649-318">Per altre indicazioni sulla progettazione dell'esperienza condivisa, vedere qui.</span><span class="sxs-lookup"><span data-stu-id="38649-318">To get further guidance on shared experience design, go here.</span></span>

## <a name="chapter-4---immersion-and-teleporting"></a><span data-ttu-id="38649-319">Capitolo 4-immersione e Teleporting</span><span class="sxs-lookup"><span data-stu-id="38649-319">Chapter 4 - Immersion and teleporting</span></span>

>[!VIDEO https://www.youtube.com/embed/kUHZ5tCOfvY]

### <a name="objectives"></a><span data-ttu-id="38649-320">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="38649-320">Objectives</span></span>

<span data-ttu-id="38649-321">Adatta l'esperienza a ogni tipo di dispositivo di realtà mista.</span><span class="sxs-lookup"><span data-stu-id="38649-321">Cater the experience to each type of mixed reality device.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="38649-322">Elementi da compilare</span><span class="sxs-lookup"><span data-stu-id="38649-322">What we will build</span></span>

<span data-ttu-id="38649-323">L'applicazione viene aggiornata in modo da inserire utenti di auricolari immersivi nell'isola con una visualizzazione immersiva.</span><span class="sxs-lookup"><span data-stu-id="38649-323">We will update the application to put immersive headset users on the island with an immersive view.</span></span> <span data-ttu-id="38649-324">Gli utenti di HoloLens avranno ancora la vista d'occhio dell'isola.</span><span class="sxs-lookup"><span data-stu-id="38649-324">HoloLens users will still have the bird's eye view of the island.</span></span> <span data-ttu-id="38649-325">Gli utenti di ogni tipo di dispositivo possono visualizzare altri utenti così come appaiono nel mondo.</span><span class="sxs-lookup"><span data-stu-id="38649-325">Users of each device type can see other users as they appear in the world.</span></span> <span data-ttu-id="38649-326">Ad esempio, gli utenti con auricolari immersivi possono visualizzare gli altri avatar su altri percorsi nell'isola e vedono gli utenti di HoloLens come cloud giganti sopra l'isola.</span><span class="sxs-lookup"><span data-stu-id="38649-326">For instance, immersive headset users can see the other avatars on other paths on the island, and they see the HoloLens users as giant clouds above the island.</span></span> <span data-ttu-id="38649-327">Gli utenti di auricolari immersivi vedranno anche il cursore del raggio di sguardi dell'utente HoloLens se l'utente HoloLens sta esaminando l'isola.</span><span class="sxs-lookup"><span data-stu-id="38649-327">Immersive headset users will also see the cursor of the HoloLens user's gaze ray if the HoloLens user is looking at the island.</span></span> <span data-ttu-id="38649-328">Gli utenti di HoloLens visualizzeranno un avatar nell'isola per rappresentare ogni utente di un headset immersivo.</span><span class="sxs-lookup"><span data-stu-id="38649-328">HoloLens users will see an avatar on the island to represent each immersive headset user.</span></span>

<span data-ttu-id="38649-329">**Input aggiornato per il dispositivo immersivo:**</span><span class="sxs-lookup"><span data-stu-id="38649-329">**Updated Input for the Immersive device:**</span></span>

* <span data-ttu-id="38649-330">I pulsanti sinistro e destro del mouse sul controller Xbox ruotano il lettore</span><span class="sxs-lookup"><span data-stu-id="38649-330">The left bumper and right bumper buttons on the Xbox controller rotate the player</span></span>
* <span data-ttu-id="38649-331">Se si tiene premuto il pulsante Y sul controller Xbox, viene abilitato un cursore [Teleport](../discover/navigating-the-windows-mixed-reality-home.md#getting-around-your-home) .</span><span class="sxs-lookup"><span data-stu-id="38649-331">Holding the Y button on the Xbox controller will enable a [teleport](../discover/navigating-the-windows-mixed-reality-home.md#getting-around-your-home) cursor.</span></span> <span data-ttu-id="38649-332">Se il cursore ha un indicatore della freccia rotante quando si rilascia il pulsante Y, verrà avviata la teleportazione nella posizione del cursore.</span><span class="sxs-lookup"><span data-stu-id="38649-332">If the cursor has a spinning arrow indicator when you release the Y button, you will be teleported to the cursor's location.</span></span>

### <a name="steps"></a><span data-ttu-id="38649-333">Passaggi</span><span class="sxs-lookup"><span data-stu-id="38649-333">Steps</span></span>

* <span data-ttu-id="38649-334">Aggiungere MixedRealityTeleport a MixedRealityCameraParent</span><span class="sxs-lookup"><span data-stu-id="38649-334">Add MixedRealityTeleport to MixedRealityCameraParent</span></span>
    * <span data-ttu-id="38649-335">In **gerarchia** selezionare **usland** .</span><span class="sxs-lookup"><span data-stu-id="38649-335">In **Hierarchy** , select **Usland** .</span></span>
    * <span data-ttu-id="38649-336">In **Inspector** , abilitare il **controllo del livello** .</span><span class="sxs-lookup"><span data-stu-id="38649-336">In **Inspector** , enable **Level Control** .</span></span>
    * <span data-ttu-id="38649-337">In **gerarchia** selezionare **MixedRealityCameraParent** .</span><span class="sxs-lookup"><span data-stu-id="38649-337">In **Hierarchy** , select **MixedRealityCameraParent** .</span></span>
    * <span data-ttu-id="38649-338">In **Inspector** fare clic su **Add Component** .</span><span class="sxs-lookup"><span data-stu-id="38649-338">In **Inspector** , click **Add Component** .</span></span>
    * <span data-ttu-id="38649-339">Digitare la **realtà mista Teleport** e selezionarla.</span><span class="sxs-lookup"><span data-stu-id="38649-339">Type **Mixed Reality Teleport** and select it.</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="38649-340">Ricerche nel codice</span><span class="sxs-lookup"><span data-stu-id="38649-340">Digging into the code</span></span>

<span data-ttu-id="38649-341">Gli utenti con auricolari immersivi saranno collegati ai PC con un cavo, ma l'isola è più grande del cavo.</span><span class="sxs-lookup"><span data-stu-id="38649-341">Immersive headset users will be tethered to their PCs with a cable, but our island is larger than the cable is long.</span></span> <span data-ttu-id="38649-342">Per compensare, è necessario avere la possibilità di spostare la fotocamera in modo indipendente dal movimento dell'utente.</span><span class="sxs-lookup"><span data-stu-id="38649-342">To compensate, we need the ability to move the camera independently of the user's motion.</span></span> <span data-ttu-id="38649-343">Per altre informazioni sulla progettazione di un'applicazione di realtà mista (in particolare movimento autonomo e locomozione), vedere la pagina relativa alla [comodità](../design/comfort.md) .</span><span class="sxs-lookup"><span data-stu-id="38649-343">Please see the [comfort page](../design/comfort.md) for more information about designing your mixed reality application (in particular self motion and locomotion).</span></span>

<span data-ttu-id="38649-344">Per descrivere questo processo, sarà utile definire due termini.</span><span class="sxs-lookup"><span data-stu-id="38649-344">In order to describe this process it will be useful to define two terms.</span></span> <span data-ttu-id="38649-345">Per prima cosa, **Dolly** sarà l'oggetto che sposta la fotocamera in modo indipendente dall'utente.</span><span class="sxs-lookup"><span data-stu-id="38649-345">First, **dolly** will be the object that moves the camera independently from the user.</span></span> <span data-ttu-id="38649-346">Un oggetto gioco figlio della **bambola** sarà la **fotocamera principale** .</span><span class="sxs-lookup"><span data-stu-id="38649-346">A child game object of the **dolly** will be the **main camera** .</span></span> <span data-ttu-id="38649-347">La videocamera principale è collegata alla testa dell'utente.</span><span class="sxs-lookup"><span data-stu-id="38649-347">The main camera is attached to the user's head.</span></span>

<span data-ttu-id="38649-348">Nel pannello del progetto passare a **Assets\AppPrefabs\Support\Scripts\GameLogic** e fare doppio clic su **MixedRealityTeleport.cs** .</span><span class="sxs-lookup"><span data-stu-id="38649-348">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **MixedRealityTeleport.cs** .</span></span>

<span data-ttu-id="38649-349">MixedRealityTeleport ha due processi.</span><span class="sxs-lookup"><span data-stu-id="38649-349">MixedRealityTeleport has two jobs.</span></span> <span data-ttu-id="38649-350">In primo luogo, gestisce la rotazione usando i paraurti.</span><span class="sxs-lookup"><span data-stu-id="38649-350">First, it handles rotation using the bumpers.</span></span> <span data-ttu-id="38649-351">Nella funzione Update viene eseguito il polling di ' ButtonUp ' in LeftBumper e RightBumper.</span><span class="sxs-lookup"><span data-stu-id="38649-351">In the update function we poll for 'ButtonUp' on LeftBumper and RightBumper.</span></span> <span data-ttu-id="38649-352">GetButtonUp restituisce true solo sul primo frame un pulsante è attivo dopo essere stato disattivato.</span><span class="sxs-lookup"><span data-stu-id="38649-352">GetButtonUp only returns true on the first frame a button is up after having been down.</span></span> <span data-ttu-id="38649-353">Se uno dei pulsanti è stato generato, è necessario che l'utente ruoti.</span><span class="sxs-lookup"><span data-stu-id="38649-353">If either button had been raised, then we know the user needs to rotate.</span></span>

<span data-ttu-id="38649-354">Quando si ruota, si esegue una dissolvenza e si dissolve l'uso di uno script semplice denominato "Fade Control".</span><span class="sxs-lookup"><span data-stu-id="38649-354">When we rotate we do a fade out and fade in using a simple script called 'fade control'.</span></span> <span data-ttu-id="38649-355">Questa operazione viene eseguita per impedire all'utente di vedere un movimento non naturale che può causare disagio.</span><span class="sxs-lookup"><span data-stu-id="38649-355">We do this to prevent the user from seeing an unnatural movement which could lead to discomfort.</span></span> <span data-ttu-id="38649-356">L'effetto di dissolvenza in entrata e in uscita è piuttosto semplice.</span><span class="sxs-lookup"><span data-stu-id="38649-356">The fade in and out effect is fairly simple.</span></span> <span data-ttu-id="38649-357">Il quadrato nero è appeso davanti alla **fotocamera principale** .</span><span class="sxs-lookup"><span data-stu-id="38649-357">We have a black quad hanging in front of the **main camera** .</span></span> <span data-ttu-id="38649-358">In caso di dissolvenza, il valore alfa viene sottoposto a transizione da 0 a 1.</span><span class="sxs-lookup"><span data-stu-id="38649-358">When fading out we transition the alpha value from 0 to 1.</span></span> <span data-ttu-id="38649-359">Questa operazione determina gradualmente il rendering dei pixel neri del quad e la relativa oscurità.</span><span class="sxs-lookup"><span data-stu-id="38649-359">This gradually causes the black pixels of the quad to render and obscure anything behind them.</span></span> <span data-ttu-id="38649-360">Quando si esegue la dissolvenza, il valore alfa viene passato a zero.</span><span class="sxs-lookup"><span data-stu-id="38649-360">When fading back in we transition the alpha value back to zero.</span></span>

<span data-ttu-id="38649-361">Quando si calcola la rotazione, si noti che viene ruotata la nostra **bambola** , ma il calcolo della rotazione intorno alla **fotocamera principale** .</span><span class="sxs-lookup"><span data-stu-id="38649-361">When we calculate the rotation, note that we are rotating our **dolly** but calculating the rotation around the **main camera** .</span></span> <span data-ttu-id="38649-362">Questo è importante perché la **fotocamera principale** è più lontana da 0, 0, 0, minore è la precisione di una rotazione intorno alla bambola, dal punto di vista dell'utente.</span><span class="sxs-lookup"><span data-stu-id="38649-362">This is important as the farther the **main camera** is away from 0,0,0, the less accurate a rotation around the dolly would become from the point of view of the user.</span></span> <span data-ttu-id="38649-363">Infatti, se non si ruota attorno alla posizione della fotocamera, l'utente si sposterà su un arco intorno alla **bambola** invece che sulla rotazione.</span><span class="sxs-lookup"><span data-stu-id="38649-363">In fact, if you do not rotate around the camera position, the user will move on an arc around the **dolly** rather than rotating.</span></span>

<span data-ttu-id="38649-364">Il secondo processo per MixedRealityTeleport consiste nel gestire lo stato di **bambola** .</span><span class="sxs-lookup"><span data-stu-id="38649-364">The second job for MixedRealityTeleport is to handle moving the **dolly** .</span></span> <span data-ttu-id="38649-365">Questa operazione viene eseguita in SetWorldPosition.</span><span class="sxs-lookup"><span data-stu-id="38649-365">This is done in SetWorldPosition.</span></span> <span data-ttu-id="38649-366">SetWorldPosition prende la posizione del mondo desiderata, ovvero la posizione in cui l'utente desidera percepire che abitano.</span><span class="sxs-lookup"><span data-stu-id="38649-366">SetWorldPosition takes the desired world position, the position where the user wants to percieve that they inhabit.</span></span> <span data-ttu-id="38649-367">Dobbiamo inserire la nostra **bambola** in quella posizione, meno la posizione locale della **fotocamera principale** , in quanto tale offset verrà aggiunto a ogni frame.</span><span class="sxs-lookup"><span data-stu-id="38649-367">We need to put our **dolly** at that position minus the local position of the **main camera** , as that offset will be added each frame.</span></span>

<span data-ttu-id="38649-368">Un secondo script chiama SetWorldPosition.</span><span class="sxs-lookup"><span data-stu-id="38649-368">A second script calls SetWorldPosition.</span></span> <span data-ttu-id="38649-369">Viene ora esaminato lo script.</span><span class="sxs-lookup"><span data-stu-id="38649-369">Let's look at that script.</span></span> <span data-ttu-id="38649-370">Nel pannello del progetto passare a **Assets\AppPrefabs\Support\Scripts\GameLogic** e fare doppio clic su **TeleportScript.cs** .</span><span class="sxs-lookup"><span data-stu-id="38649-370">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **TeleportScript.cs** .</span></span>

<span data-ttu-id="38649-371">Questo script è un po' più impegnativo rispetto a MixedRealityTeleport.</span><span class="sxs-lookup"><span data-stu-id="38649-371">This script is a little more involved than MixedRealityTeleport.</span></span> <span data-ttu-id="38649-372">Lo script sta controllando che il pulsante Y del controller Xbox venga mantenuto attivo.</span><span class="sxs-lookup"><span data-stu-id="38649-372">The script is checking for the Y Button on the Xbox controller to be held down.</span></span> <span data-ttu-id="38649-373">Mentre il pulsante è premuto, viene eseguito il rendering di un cursore Teleport e lo script esegue il cast di un raggio dalla posizione dello sguardo dell'utente.</span><span class="sxs-lookup"><span data-stu-id="38649-373">While the button is held down a teleport cursor is rendered and the script casts a ray from the user's gaze position.</span></span> <span data-ttu-id="38649-374">Se il raggio si scontra con una superficie che è più o meno rivolta verso l'alto, la superficie verrà considerata una superficie corretta per il teletrasporto e l'animazione sul cursore Teleport verrà abilitata.</span><span class="sxs-lookup"><span data-stu-id="38649-374">If that ray collides with a surface that is more or less pointing up, the surface will be considered a good surface to teleport to, and the animation on the teleport cursor will be enabled.</span></span> <span data-ttu-id="38649-375">Se il raggio non entra in conflitto con una superficie più o meno rivolta verso l'alto, l'animazione sul cursore verrà disabilitata.</span><span class="sxs-lookup"><span data-stu-id="38649-375">If the ray does not collide with a surface more or less pointing up, then the animation on the cursor will be disabled.</span></span> <span data-ttu-id="38649-376">Quando il pulsante Y viene rilasciato e il punto calcolato del raggio è una posizione valida, lo script chiama SetWorldPosition con la posizione in cui è intersecato il raggio.</span><span class="sxs-lookup"><span data-stu-id="38649-376">When the Y button is released and the calculated point of the ray is a valid position, the script calls SetWorldPosition with the position the ray intersected.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="38649-377">Scopri lo stato di avanzamento</span><span class="sxs-lookup"><span data-stu-id="38649-377">Enjoy your progress</span></span>

<span data-ttu-id="38649-378">Questa volta è necessario trovare un amico.</span><span class="sxs-lookup"><span data-stu-id="38649-378">This time you'll need to find a friend.</span></span>

<span data-ttu-id="38649-379">Ancora una volta, un utente con il HoloLens ospiterà una sessione.</span><span class="sxs-lookup"><span data-stu-id="38649-379">Once again, a user with the HoloLens will host a session.</span></span> <span data-ttu-id="38649-380">Altri utenti faranno parte della sessione.</span><span class="sxs-lookup"><span data-stu-id="38649-380">Other users will join the session.</span></span> <span data-ttu-id="38649-381">L'applicazione inserisce i primi tre utenti in join da un auricolare immersivo in uno dei tre percorsi dell'isola.</span><span class="sxs-lookup"><span data-stu-id="38649-381">The application will place the first three users to join from an immersive headset on one of the three paths on the island.</span></span> <span data-ttu-id="38649-382">È possibile esplorare l'isola in questa sezione.</span><span class="sxs-lookup"><span data-stu-id="38649-382">Feel free to explore the island in this section.</span></span>

<span data-ttu-id="38649-383">Dettagli da notare:</span><span class="sxs-lookup"><span data-stu-id="38649-383">Details to notice:</span></span>

1. <span data-ttu-id="38649-384">È possibile visualizzare i visi nei cloud, che consentono a un utente immerso di vedere quale direzione sta cercando un utente HoloLens.</span><span class="sxs-lookup"><span data-stu-id="38649-384">You can see faces in the clouds, which helps an immersed user see which direction a HoloLens user is looking.</span></span>
2. <span data-ttu-id="38649-385">Gli avatar nell'isola hanno colli che ruotano.</span><span class="sxs-lookup"><span data-stu-id="38649-385">The avatars on the island have necks that rotate.</span></span> <span data-ttu-id="38649-386">Non seguiranno le operazioni che l'utente sta eseguendo è la realtà reale (queste informazioni non sono disponibili), ma è un'esperienza interessante.</span><span class="sxs-lookup"><span data-stu-id="38649-386">They won't follow what the user is doing is real reality (we don't have that information) but it makes for a nice experience.</span></span>
3. <span data-ttu-id="38649-387">Se l'utente HoloLens sta esaminando l'isola, gli utenti immersi possono visualizzarne il cursore.</span><span class="sxs-lookup"><span data-stu-id="38649-387">If the HoloLens user is looking at the Island, the immersed users can see their cursor.</span></span>
4. <span data-ttu-id="38649-388">I cloud che rappresentano gli utenti HoloLens hanno eseguito il cast delle ombreggiature.</span><span class="sxs-lookup"><span data-stu-id="38649-388">The clouds that represent the HoloLens users cast shadows.</span></span>

## <a name="chapter-5---finale"></a><span data-ttu-id="38649-389">Capitolo 5-finali</span><span class="sxs-lookup"><span data-stu-id="38649-389">Chapter 5 - Finale</span></span>

>[!VIDEO https://www.youtube.com/embed/n_HDWJbfpNg]

### <a name="objectives"></a><span data-ttu-id="38649-390">Obiettivi</span><span class="sxs-lookup"><span data-stu-id="38649-390">Objectives</span></span>

<span data-ttu-id="38649-391">Creare un'esperienza interattiva collaborativa tra i due tipi di dispositivi.</span><span class="sxs-lookup"><span data-stu-id="38649-391">Create a collaborative interactive experience between the two device types.</span></span>

### <a name="what-we-will-build"></a><span data-ttu-id="38649-392">Elementi da compilare</span><span class="sxs-lookup"><span data-stu-id="38649-392">What we will build</span></span>

<span data-ttu-id="38649-393">Basandosi sul capitolo 4, quando un utente con una cuffia coinvolgente si avvicina a un rompicapo nell'isola, gli utenti di HoloLens otterranno una descrizione comando con un indizio sul puzzle.</span><span class="sxs-lookup"><span data-stu-id="38649-393">Building on chapter 4, when a user with an immersive headset gets near a puzzle on the island, the HoloLens users will get a tool tip with a clue to the puzzle.</span></span> <span data-ttu-id="38649-394">Una volta che tutti gli utenti di auricolari immersivi hanno superato i loro rompicapo e il "pad pronto" nella sala Rocket, il Rocket si avvierà.</span><span class="sxs-lookup"><span data-stu-id="38649-394">Once all of the immersive headset users get past their puzzles and onto the "ready pad" in the rocket room, the rocket will launch.</span></span>

### <a name="steps"></a><span data-ttu-id="38649-395">Passaggi</span><span class="sxs-lookup"><span data-stu-id="38649-395">Steps</span></span>

* <span data-ttu-id="38649-396">In **gerarchia** selezionare **usland** .</span><span class="sxs-lookup"><span data-stu-id="38649-396">In **Hierarchy** , select **Usland** .</span></span>
* <span data-ttu-id="38649-397">In **Inspector** controllo, in **controllo livello** , selezionare **Abilita collaborazione** .</span><span class="sxs-lookup"><span data-stu-id="38649-397">In **Inspector** , in **Level Control** , check **Enable Collaboration** .</span></span>

### <a name="digging-into-the-code"></a><span data-ttu-id="38649-398">Ricerche nel codice</span><span class="sxs-lookup"><span data-stu-id="38649-398">Digging into the code</span></span>

<span data-ttu-id="38649-399">Esaminiamo ora LevelControl.cs.</span><span class="sxs-lookup"><span data-stu-id="38649-399">Now let us look at LevelControl.cs.</span></span> <span data-ttu-id="38649-400">Questo script è il nucleo della logica del gioco e mantiene lo stato del gioco.</span><span class="sxs-lookup"><span data-stu-id="38649-400">This script is the core of the game logic and maintains the game state.</span></span> <span data-ttu-id="38649-401">Poiché si tratta di un gioco multiplayer che usa UNET è necessario comprendere in che modo i flussi di dati, almeno abbastanza bene per modificare questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="38649-401">Since this is a multiplayer game using UNET we need to understand how data flows, at least well enough to modify this tutorial.</span></span> <span data-ttu-id="38649-402">Per una panoramica più completa di UNET, vedere la documentazione di Unity.</span><span class="sxs-lookup"><span data-stu-id="38649-402">For a more complete overview of UNET, please refer to Unity's documentation.</span></span>

<span data-ttu-id="38649-403">Nel pannello del progetto passare a **Assets\AppPrefabs\Support\Scripts\GameLogic** e fare doppio clic su **LevelControl.cs** .</span><span class="sxs-lookup"><span data-stu-id="38649-403">In the project panel, navigate to **Assets\AppPrefabs\Support\Scripts\GameLogic** and double-click on **LevelControl.cs** .</span></span>

<span data-ttu-id="38649-404">Viene ora illustrato come una cuffia immersiva indica che sono pronte per il lancio del Rocket.</span><span class="sxs-lookup"><span data-stu-id="38649-404">Let us understand how an immersive headset indicates that they are ready for the rocket launch.</span></span> <span data-ttu-id="38649-405">La preparazione del lancio Rocket viene comunicata impostando uno dei tre bool in un elenco di bool che corrispondono ai tre percorsi nell'isola.</span><span class="sxs-lookup"><span data-stu-id="38649-405">Rocket Launch readiness is communicated by setting one of three bools in a list of bools that correspond to the three paths on the island.</span></span> <span data-ttu-id="38649-406">Il valore bool di un percorso verrà impostato quando l'utente assegnato al percorso si trova sopra il riquadro marrone all'interno della sala Rocket.</span><span class="sxs-lookup"><span data-stu-id="38649-406">A path's bool will be set when the user assigned to the path is on top of the brown pad inside the rocket room.</span></span> <span data-ttu-id="38649-407">Bene. ora i dettagli.</span><span class="sxs-lookup"><span data-stu-id="38649-407">Okay, now to the details.</span></span>

<span data-ttu-id="38649-408">Si inizierà con la funzione Update ().</span><span class="sxs-lookup"><span data-stu-id="38649-408">We will start in the Update() function.</span></span> <span data-ttu-id="38649-409">Si noterà che è presente una funzione "cheat".</span><span class="sxs-lookup"><span data-stu-id="38649-409">You will note that there is a 'cheat' function.</span></span> <span data-ttu-id="38649-410">Questa operazione è stata usata in fase di sviluppo per testare la sequenza di avvio e reimpostazione del Rocket.</span><span class="sxs-lookup"><span data-stu-id="38649-410">We used this in development to test the rocket launch and reset sequence.</span></span> <span data-ttu-id="38649-411">Non funzionerà nell'esperienza multiutente.</span><span class="sxs-lookup"><span data-stu-id="38649-411">It won't work in the multi user experience.</span></span> <span data-ttu-id="38649-412">Si spera che nel momento in cui si interiorizzano gli indici seguenti è possibile farlo funzionare.</span><span class="sxs-lookup"><span data-stu-id="38649-412">Hopefully by the time you internalize the following infromation you can make it work.</span></span> <span data-ttu-id="38649-413">Dopo aver verificato se è necessario imbrogliare, viene verificato se il lettore locale è immerso.</span><span class="sxs-lookup"><span data-stu-id="38649-413">After we check to see if we should cheat, we check to see if the local player is immersed.</span></span> <span data-ttu-id="38649-414">Vogliamo concentrarci sul modo in cui siamo in grado di raggiungere l'obiettivo.</span><span class="sxs-lookup"><span data-stu-id="38649-414">We want to focus on how we find that we're at the goal.</span></span> <span data-ttu-id="38649-415">All'interno del controllo if (immerso) è presente una chiamata a CheckGoal nascosta dietro **EnableCollaboration** bool.</span><span class="sxs-lookup"><span data-stu-id="38649-415">Inside of the if (Immersed) check, there is a call to CheckGoal hiding behind the **EnableCollaboration** bool.</span></span> <span data-ttu-id="38649-416">Corrisponde alla casella di controllo selezionata durante il completamento dei passaggi per questo capitolo.</span><span class="sxs-lookup"><span data-stu-id="38649-416">This corresponds to the checkbox you checked while completing the steps for this chapter.</span></span> <span data-ttu-id="38649-417">All'interno di EnableCollaboration viene visualizzata una chiamata a CheckGoal ().</span><span class="sxs-lookup"><span data-stu-id="38649-417">Inside of EnableCollaboration we see a call to CheckGoal().</span></span>

<span data-ttu-id="38649-418">CheckGoal esegue alcuni calcoli matematici per verificare se il pad è più o meno in piedi.</span><span class="sxs-lookup"><span data-stu-id="38649-418">CheckGoal does some math to see if we are more or less standing on the pad.</span></span> <span data-ttu-id="38649-419">Quando ci troviamo, eseguiamo il debug. log "arrivato all'obiettivo" e chiamiamo "SendAtGoalMessage ()".</span><span class="sxs-lookup"><span data-stu-id="38649-419">When we are, we Debug.Log "Arrived at goal" and then we call 'SendAtGoalMessage()'.</span></span> <span data-ttu-id="38649-420">In SendAtGoalMessage viene chiamato playerController. SendAtGoal.</span><span class="sxs-lookup"><span data-stu-id="38649-420">In SendAtGoalMessage we call playerController.SendAtGoal.</span></span> <span data-ttu-id="38649-421">Per risparmiare tempo, ecco il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="38649-421">To save you some time, here's the code:</span></span>

```cs
private void CmdSendAtGoal(int GoalIndex)
{
    levelState.SetGoalIndex(GoalIndex);
}
```

```cs
public void SendAtGoal(int GoalIndex)
{
    if (isLocalPlayer)
    {
        Debug.Log("sending at goal " + GoalIndex);
        CmdSendAtGoal(GoalIndex);
    }
}
```

<span data-ttu-id="38649-422">Si noti che SendAtGoalMessage chiama CmdSendAtGoal, che chiama levelState. SetGoalIndex, che è di nuovo in LevelControl.cs.</span><span class="sxs-lookup"><span data-stu-id="38649-422">Note that SendAtGoalMessage calls CmdSendAtGoal, which calls levelState.SetGoalIndex, which is back in LevelControl.cs.</span></span> <span data-ttu-id="38649-423">A prima vista, sembra strano.</span><span class="sxs-lookup"><span data-stu-id="38649-423">At first glance this seems strange.</span></span> <span data-ttu-id="38649-424">Perché non è sufficiente chiamare SetGoalIndex anziché questo strano routing tramite il controller del lettore?</span><span class="sxs-lookup"><span data-stu-id="38649-424">Why not just call SetGoalIndex rather than this strange routing through the player controller?</span></span> <span data-ttu-id="38649-425">Il motivo è che è conforme al modello di dati usato da UNET per la sincronizzazione dei dati. Per evitare frodi e thrashing, UNET richiede che ogni oggetto disponga di un utente con l'autorità di modificare le variabili sincronizzate.</span><span class="sxs-lookup"><span data-stu-id="38649-425">The reason is that we are conforming to the data model UNET uses to keep data in sync. To prevent cheating and thrashing, UNET requires that each object has a user who has authority to change the synchronized variables.</span></span> <span data-ttu-id="38649-426">Inoltre, solo l'host (l'utente che ha avviato la sessione) può modificare direttamente i dati.</span><span class="sxs-lookup"><span data-stu-id="38649-426">Further, only the host (the user that started the session) can change data directly.</span></span> <span data-ttu-id="38649-427">Gli utenti che non sono host, ma hanno l'autorità necessaria per inviare un "comando" all'host che modificherà la variabile.</span><span class="sxs-lookup"><span data-stu-id="38649-427">Users who are not the host, but have authority, need to send a 'command' to the host which will change the variable.</span></span> <span data-ttu-id="38649-428">Per impostazione predefinita, l'host dispone di autorità su tutti gli oggetti, ad eccezione dell'oggetto generato per rappresentare l'utente.</span><span class="sxs-lookup"><span data-stu-id="38649-428">By default the host has authority over all objects, except for the object spawned to represent the user.</span></span> <span data-ttu-id="38649-429">In questo caso l'oggetto ha lo script PlayerController.</span><span class="sxs-lookup"><span data-stu-id="38649-429">In our case this object has the playercontroller script.</span></span> <span data-ttu-id="38649-430">Esiste un modo per richiedere un'autorità per un oggetto e quindi apportare le modifiche, ma si sceglie di sfruttare il fatto che il controller del lettore dispone di autoauthority e indirizzare i comandi attraverso il controller del lettore.</span><span class="sxs-lookup"><span data-stu-id="38649-430">There is a way to request authority for an object and then make changes, but we choose to leverage the fact that the player controller has self authority and route commands through the player controller.</span></span>

<span data-ttu-id="38649-431">Detto un altro modo, quando ci siamo trovati al nostro obiettivo, il giocatore deve indicare all'host che l'host ne dirà tutti gli altri.</span><span class="sxs-lookup"><span data-stu-id="38649-431">Said another way, when we've found ourselves at our goal, the player needs to tell the host, and the host will tell everyone else.</span></span>

<span data-ttu-id="38649-432">Tornando a LevelControl.cs, vedere SetGoalIndex.</span><span class="sxs-lookup"><span data-stu-id="38649-432">Back in LevelControl.cs look at SetGoalIndex.</span></span> <span data-ttu-id="38649-433">Qui viene impostato il valore di un valore in un elenco di sincronizzazione (AtGoal).</span><span class="sxs-lookup"><span data-stu-id="38649-433">Here we are setting the value of a value in a synclist (AtGoal).</span></span> <span data-ttu-id="38649-434">Si tenga presente che il contesto dell'host è in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="38649-434">Remember that we are in the context of the host while we do this.</span></span> <span data-ttu-id="38649-435">Analogamente a un comando, una RPC è un elemento che può essere emesso dall'host che farà sì che tutti i client eseguano il codice.</span><span class="sxs-lookup"><span data-stu-id="38649-435">Similar to a command, an RPC is something the host can issue that will cause all clients to run some code.</span></span> <span data-ttu-id="38649-436">Qui chiamiamo ' RpcCheckAllGoals '.</span><span class="sxs-lookup"><span data-stu-id="38649-436">Here we call 'RpcCheckAllGoals'.</span></span> <span data-ttu-id="38649-437">Ogni client verificherà singolarmente se sono state impostate tutte e tre le AtGoals e, in caso affermativo, avvierà il Rocket.</span><span class="sxs-lookup"><span data-stu-id="38649-437">Each client will individually check to see if all three AtGoals are set, and if so, launch the rocket.</span></span>

### <a name="enjoy-your-progress"></a><span data-ttu-id="38649-438">Scopri lo stato di avanzamento</span><span class="sxs-lookup"><span data-stu-id="38649-438">Enjoy your progress</span></span>

<span data-ttu-id="38649-439">Per la compilazione nel capitolo precedente, la sessione viene avviata come prima.</span><span class="sxs-lookup"><span data-stu-id="38649-439">Building on the previous chapter, we will start the session as before.</span></span> <span data-ttu-id="38649-440">Questa volta, quando gli utenti nell'auricolare immersiva entrano nello "sportello" sul percorso, viene visualizzata una descrizione comando che solo gli utenti HoloLens possono vedere.</span><span class="sxs-lookup"><span data-stu-id="38649-440">This time as the users in the immersive headset get to the "door" on their path, a tooltip will appear that only the HoloLens users can see.</span></span> <span data-ttu-id="38649-441">Gli utenti di HoloLens sono responsabili della comunicazione di questo indizio agli utenti nell'auricolare immersiva.</span><span class="sxs-lookup"><span data-stu-id="38649-441">The HoloLens users are responsible for communicating this clue to the users in the immersive headset.</span></span> <span data-ttu-id="38649-442">Il Rocket si avvierà allo spazio quando ogni avatar ha risalendo al Pad marrone corrispondente all'interno del vulcano.</span><span class="sxs-lookup"><span data-stu-id="38649-442">The rocket will launch to space once each avatar has stepped on its corresponding brown pad inside the volcano.</span></span> <span data-ttu-id="38649-443">La scena viene reimpostata dopo 60 secondi, quindi è possibile eseguirla di nuovo.</span><span class="sxs-lookup"><span data-stu-id="38649-443">The scene will reset after 60 seconds so you can do it again.</span></span>

## <a name="see-also"></a><span data-ttu-id="38649-444">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="38649-444">See also</span></span>

* [<span data-ttu-id="38649-445">Input MR 213: Controller del movimento</span><span class="sxs-lookup"><span data-stu-id="38649-445">MR Input 213: Motion controllers</span></span>](mixed-reality-213.md)
